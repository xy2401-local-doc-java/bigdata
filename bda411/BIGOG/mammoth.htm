<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Installing the Oracle Big Data Appliance Software</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="keywords" content="Rolling upgrades, installation prerequisites, prerequisites to software installation, ASR, Oracle Enterprise Manager plug-in installation prerequisites, Kerberos authentication, installation prerequisites (remote KDC only), image version, upgrading, upgrading the factory image, software image, downgrading, downgrading the factory image, software installation, upgrading the software, factory image reinstallation, base image reinstallation, racks, reinstalling base image, reimaging the servers, servers, upgrading base image, installing base image, Mammoth Utility, location, SetupHadoopSecurity step, enabling Kerberos, enabling Sentry, enabling Network Encryption, enabling Transparent Encryption, setting mount points, execution steps, SetupInstall step, SetupPuppet step, Puppet utility, PatchFactoryImage step, installing patches, patch installation, factory patches, CopyLicenseFiles step, license location, third-party license location, CreateUsers step, external filer configuration, SetupMySQL step, MySQL Database installation, InstallHadoop step, Hadoop installation, CDH installation, StartHadoopServices step, services, starting, Hadoop services, starting, CDH services, starting, InstallBDASoftware step, Oracle NoSQL Database, installation, Oracle Big Data Connectors, SetupKerberos step, Kerberos configuration, SetupASR step, Auto Service Request, installing, CleanupInstall step, CleanupSSHroot step, makebdaimage utility, base image utilities, reimagecluster utility, cluster reimaging, reimagerack utility, reimaging" />
<meta name="dcterms.created" content="2018-07-23T20:06:30Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Big Data Appliance Owner's Guide" />
<meta name="dcterms.identifier" content="E89801-07" />
<meta name="dcterms.isVersionOf" content="BIGOG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2011, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="http://www.docs.oracle.com/bigdata/411/index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="part-software-installation.htm" title="Previous" type="text/html" />
<link rel="Next" href="part-maintenance.htm" title="Next" type="text/html" />
<link rel="alternate" href="BIGOG.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-2D0DC456-2DD1-4894-A5FA-3CC612CD9C5A"></a> <span id="PAGE" style="display:none;">17/38</span> <!-- End Header -->
<a id="BIGOG76659"></a>
<h1 id="BIGOG-GUID-2D0DC456-2DD1-4894-A5FA-3CC612CD9C5A" class="sect1"><span class="enumeration_chapter">10</span> Installing the Oracle Big Data Appliance Software</h1>
<div>
<p>This chapter explains how to install, reinstall, and reconfigure the software on Oracle Big Data Appliance. It contains these sections:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="mammoth.htm#GUID-AE60E01C-0853-487A-A43A-A687470E3876">About the Mammoth Utility</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-5D0B03C7-7205-4752-BBB9-CFBD69EFD109">Installation Prerequisites</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-29022554-078A-4E5F-9868-4AD9AF3858AA">Downloading the Mammoth Software Deployment Bundle</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-E6355C9C-BCE5-485A-80A0-DC80CFC36842">Installing the Software on a New Rack</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5">Adding Servers to a Cluster</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-C9A914CE-524B-4EF4-9EDF-13D768530195">What If an Error Occurs During the Installation?</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-35C6A18E-94E1-40B7-9193-F461D5AFCBC0" title="Oracle one-off patches for Oracle Big Data Appliance software are by definition supported.&nbsp;Parcel upgrades that are not part of a one-off patch are unsupported unless affirmed by Oracle Support.">Upgrading the Software on Oracle Big Data Appliance</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-D9B445F2-A5DD-4C6C-9BA1-2F5330ED4798" title="This release of Oracle Big Data Appliance supports Oracle Big Data Discovery 1.5 as well as 1.4 (1.4.0.37.1388 or greater).Oracle Big Data SQL can be installed via the Mammoth or bdacli utilities. Earlier releases are automatically upgraded on the Oracle Big Data Appliance side.When you install Oracle Big Data SQL on Oracle Big Data Appliance, this process also generates a database-side installation bundle. Install this bundle on the database system where you intend to run Oracle Big Data SQL queries against the Hadoop data on Oracle Big Data Appliance.">Changing the Configuration of Optional Software</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-D9F92052-5A1B-44BA-8B95-5B4C10D57DA1">Reinstalling the Base Image</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-24573DBB-79A4-4CFB-8526-2A9E840E4097">Installing a One-Off Patch</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-2C9C6188-2D32-41C0-9BE7-098109B7416F">Mammoth Software Installation and Configuration Utility</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-C87C7224-3ED6-4C75-BD37-08C98FCB94CA">Oracle Big Data Appliance Base Imaging Utilities</a></p>
</li>
</ul>
<div class="infobox-note" id="GUID-2D0DC456-2DD1-4894-A5FA-3CC612CD9C5A__GUID-30A43302-A633-42A1-B069-5596A815F8D0">
<p class="notep1">Note:</p>
<p>If you did not enter the required passwords in the Oracle Big Data Appliance Configuration Generation Utility, then you are prompted to enter them during the software installation. Ensure that you know the current passwords for the operating system root and oracle users, the Cloudera Manager <code class="codeph">admin</code> user, and the MySQL administrator. If you are installing or reinstalling Oracle Big Data Connectors, then you also need the MySQL password for Oracle Data Integrator.</p>
</div>
</div>
<a id="BIGOG76855"></a>
<div class="props_rev_3"><a id="GUID-AE60E01C-0853-487A-A43A-A687470E3876"></a>
<h2 id="BIGOG-GUID-AE60E01C-0853-487A-A43A-A687470E3876" class="sect2"><span class="enumeration_section">10.1</span> About the Mammoth Utility</h2>
<div>
<p>Mammoth is a command-line utility for installing and configuring the Oracle Big Data Appliance software. Using Mammoth, you can:</p>
<ul style="list-style-type: disc;">
<li>
<p>Set up a cluster for either CDH or Oracle NoSQL Database.</p>
</li>
<li>
<p>Create a cluster on one or more racks.</p>
</li>
<li>
<p>Create multiple clusters on an Oracle Big Data Appliance rack.</p>
</li>
<li>
<p>Extend a cluster to new servers on the same rack or a new rack.</p>
</li>
<li>
<p>Update a cluster with new software.</p>
</li>
</ul>
</div>
<div class="sect3"><a id="GUID-FD6DE509-12FA-4CE5-A454-DF61AE04C19B"></a>
<h3 id="BIGOG-GUID-FD6DE509-12FA-4CE5-A454-DF61AE04C19B" class="sect3"><span class="enumeration_section">10.1.1</span> About Rolling Upgrades</h3>
<div>
<p>A rolling upgrade reboots the nodes of a cluster in a sequence that always leaves one node out of three replicas active. This allows the cluster to stay on-line throughout the entire series of reboots. As a result, some (though not all) services of the cluster can remain accessible without interruption during the upgrade.</p>
<p>Rolling upgrades are only available for installations running CDH 4.1 or later.</p>
<p>Because sequential reboots of the nodes in pairs incrementally add time to the process, rolling upgrades take longer than a conventional Mammoth upgrade, in which all servers reboots are concurrent. Estimate an average of 8-10 minutes per pair of non-critical nodes, in addition to 4 minutes each for the Mammoth node and critical nodes (which are rebooted one at a time).</p>
<p>A rolling upgrade can be unattended. The reboot event will &ldquo;roll&rdquo; from one server to the next (or next pair) automatically if each server's post-upgrade reboot is successful. If the update detects error or warning conditions during a server reboot, then the process pauses and prompts you to continue.</p>
<pre dir="ltr">
Reboot of node mnode22bda08 had errors/warnings, do you wish to proceed anyway? [y/n]:
</pre>
<ul style="list-style-type: disc;">
<li>
<p>If you enter <code class="codeph">n</code>:</p>
<p>The upgrade stops so that you can fix the problems.</p>
<p>When you are ready, resume the installation using <code class="codeph">mammoth -p</code>.</p>
</li>
<li>
<p>if you enter <code class="codeph">y</code>:</p>
<p>The upgrade continues.</p>
</li>
</ul>
<p>This prompt is displayed once per node upgrade. If the node has already been rebooted (and the prompt has already been answered) then the upgrade will continue without displaying the prompt again.</p>
<div class="section">
<p class="subhead3">When Rolling Upgrades are Possible</p>
<p>A rolling upgrade is an option for the following upgrade tasks described in this document:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="mammoth.htm#GUID-35C6A18E-94E1-40B7-9193-F461D5AFCBC0" title="Oracle one-off patches for Oracle Big Data Appliance software are by definition supported.&nbsp;Parcel upgrades that are not part of a one-off patch are unsupported unless affirmed by Oracle Support.">Upgrading the Software on Oracle Big Data Appliance</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-24573DBB-79A4-4CFB-8526-2A9E840E4097">Installing a One-Off Patch</a></p>
</li>
</ul>
<p>For <a href="mammoth.htm#GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5">Adding Servers to a Cluster</a>, there is normally no cluster downtime for the process. The only exception is that the first time a single-rack cluster is extended onto a second rack, there will be downtime for the cluster extension (as master roles are moved to the additional rack), but subsequent cluster extensions will not require any downtime.</p>
<p>In cases where rolling upgrade is an option, Mammoth displays the following message on the console and then prompts you to chose whether or not to proceed with the installation as a rolling upgrade:</p>
<pre dir="ltr">
You can choose a rolling upgrade or continue with a conventional upgrade. Rolling upgrades need a minimum replication factor of three (this is the default in Mammoth) to have full availability during the upgrade. Do you wish to perform a Rolling Upgrade? [y/n]:  
</pre>
<div class="infobox-note" id="GUID-FD6DE509-12FA-4CE5-A454-DF61AE04C19B__GUID-2AE2A5DB-EABB-42D2-8E6A-0D6BDA4178C7">
<p class="notep1">Note:</p>
If you enter <code class="codeph">y</code> at the prompt to accept a rolling upgrade , the cluster is committed to the process and the upgrade of all nodes in the cluster must continue to completion uninterrupted.</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Service Availability During a Rolling Upgrade</p>
<p>In a rolling upgrade, services that are configured to use HDFS High Availability (HDFS HA) can remain continuously available while each node in the cluster is upgraded and rebooted. These include HDFS, YARN, and Zookeeper. Keeping these services available during the upgrade requires a Hadoop replication factor of three or greater. This is because the rolling upgrade restarts nodes in pairs. The upgrade cannot predetermine if the replication factor meets this minimum, since global configuration may have been overwritten for individual files. An insufficient replication factor does not stop the upgrade, but in that case HDFS HA-enabled services may be subject to downtime.</p>
<p>In a rolling upgrade, Cloudera services are restarted in batches of two. This is what sustains access to HDFS and other services during an upgrade. Services that are not or cannot be configured to use HDFS HA may be unavailable during a rolling upgrade, regardless of the replication factor.</p>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BIGOG76898"></a>
<div class="props_rev_3"><a id="GUID-5D0B03C7-7205-4752-BBB9-CFBD69EFD109"></a>
<h2 id="BIGOG-GUID-5D0B03C7-7205-4752-BBB9-CFBD69EFD109" class="sect2"><span class="enumeration_section">10.2</span> Installation Prerequisites</h2>
<div>
<p>The Oracle Enterprise Manager options require software on a remote server on the same network as Oracle Big Data Appliance. Those installations must be complete before you run Mammoth, or it will fail.</p>
<p>Similarly, you must complete several steps for Kerberos if the <a id="d43346e251" class="indexterm-anchor"></a>key distribution center (KDC) is installed on a remote server. There are no preliminary steps if you install the KDC on Oracle Big Data Appliance.</p>
<p>The following list describes the prerequisites for all installation options.</p>
<div class="section">
<p class="subhead2">Auto Service Request Requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>Your My Oracle Support account is set up.</p>
</li>
<li>
<p>ASR Manager is up and running.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Enterprise Manager Requirements:</p>
<ul style="list-style-type: disc;">
<li>
<p>Oracle Management System (OMS) version 12.1.0.4.0 or higher is up and running.</p>
</li>
<li>
<p>The OMS agent pull URL is working.</p>
</li>
<li>
<p>The OMS <code class="codeph">emcli</code> download URL is working.</p>
</li>
<li>
<p>Both the HTTPS upload port and the console port are open.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-5D0B03C7-7205-4752-BBB9-CFBD69EFD109__GUID-0E8F8C46-B776-4715-B290-AB8BB3B5CE90">
<p class="notep1">Note:</p>
<p>Double-check the OMS credentials and ensure that you enter them correctly when running Mammoth. Invalid credentials are the primary cause of failure in the <a id="d43346e289" class="indexterm-anchor"></a>Enterprise Manager discovery process.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">MIT Kerberos Requirements for a Remote KDC:</p>
<ol>
<li>
<p>Add <code class="codeph">cloudera-scm/admin</code> as a user to the KDC database by running the following command from <code class="codeph">kadmin</code>:</p>
<pre dir="ltr">
addprinc -randkey cloudera-scm/admin@&lt;<span class="italic">REALM NAME</span>&gt;
</pre></li>
<li>
<p>Grant <code class="codeph">cloudera-scm/admin</code> all permissions to the Kerberos database. It must be able to add, modify, remove, and list principals from the database.</p>
</li>
<li>
<p>Create the <a id="d43346e321" class="indexterm-anchor"></a><code class="codeph">cmf.keytab</code> file by running the following command from <code class="codeph">kadmin</code>:</p>
<pre dir="ltr">
xst -k cmf.keytab cloudera-scm/admin@&lt;<span class="italic">REALM NAME</span>&gt; 
</pre></li>
<li>
<p>Move <code class="codeph">cmf.keytab</code> to<code class="codeph">/opt/oracle/BDAMammoth</code>.</p>
</li>
<li>
<p>To support Oozie and Hue, ensure that the remote KDC supports renewable tickets. If it does not, then follow these steps:</p>
<ol>
<li>
<p>Open <code class="codeph">kdc.conf</code> and set values for <code class="codeph">max_life</code> and <code class="codeph">max_renewable_life</code>. The <code class="codeph">max_life</code> parameter defines the time period when the ticket is valid, and the <code class="codeph">max_renewable_life</code> parameter defines the time period when users can renew a ticket.</p>
</li>
<li>
<p>Set <code class="codeph">maxrenewlife</code> for the <code class="codeph">krbtgt</code> principal. Use the following <code class="codeph">kadmin</code> command, replacing <span class="italic">duration</span> with the time period and <span class="italic">REALM NAME</span> with the name of the realm:</p>
<pre dir="ltr">
modprinc -maxrenewlife <span class="italic">duration</span> krbtgt/<span class="italic">REALM NAME</span>
</pre></li>
</ol>
<p>If the KDC does not support renewable tickets when Kerberos is configured, then Oozie and Hue might not work correctly.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Active Directory Kerberos Requirements for a Remote KDC</p>
<p>Active Directory Kerberos requirements are documented in MOS (My Oracle Support).</p>
<p>See MOS documents 2013585.1 and 2029378.1.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76899"></a>
<div class="props_rev_3"><a id="GUID-29022554-078A-4E5F-9868-4AD9AF3858AA"></a>
<h2 id="BIGOG-GUID-29022554-078A-4E5F-9868-4AD9AF3858AA" class="sect2"><span class="enumeration_section">10.3</span> Downloading the Mammoth Software Deployment Bundle</h2>
<div>
<div class="section">
<p>The <a id="d43346e422" class="indexterm-anchor"></a>Mammoth bundle contains the installation files and the base image. Before you install the software, you must use Oracle Big Data Appliance Configuration Generation Utility to generate the configuration files, as described in <span class="q">"<a href="configurator.htm#GUID-92C6E1FE-6107-4170-BC08-66C4CF9FEE41">Generating the Configuration Files</a>."</span></p>
<p>You use the same bundle for all procedures described in this chapter, regardless of rack size, and whether you are creating CDH or Oracle NoSQL Database clusters, or upgrading existing clusters.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To download the Mammoth bundle:</p>
<ol>
<li>
<p>Locate the download site in either My Oracle Support or Automated Release Updates (ARU):</p>
<p><span class="bold">My Oracle Support</span></p>
<ol>
<li>
<p>Log on to <a href="https://support.oracle.com" target="_blank">My Oracle Support</a> and search for <span class="italic">Oracle Big Data Appliance Patch Set Master Note (Doc ID 1485745.1).</span></p>
</li>
<li>
<p>In the list provided, click the link to the Mammoth Bundle software version for this release.</p>
</li>
<li>
<p>Find the link to the appropriate Mammoth patch bundle in the table.</p>
</li>
</ol>
<p><span class="bold">ARU</span></p>
<ol>
<li>
<p>Connect to ARU.</p>
</li>
<li>
<p>On the Patches page, set Product to Big Data Appliance Integrated Software and Release to the appropriate release number.</p>
</li>
<li>
<p>Click <span class="bold">Search</span>.</p>
</li>
</ol>
</li>
<li>
<p>Download the BDA Mammoth ZIP files to any directory (such as <code class="codeph">/tmp</code>) in the first node of the cluster. Depending on the configuration of the rack, this node can be the first, seventh, or thirteenth server from the bottom of the rack. For multirack clusters, this server is in the primary rack.</p>
<p>The patch consists of a set of files labeled as follows:<code class="codeph">p</code>&lt;<span class="italic"><code class="codeph">patch_number</code></span>&gt;<code class="codeph">_Linux-x86-64_&lt;<span class="codeinlineitalic">file number</span>&gt;of&lt;<span class="codeinlineitalic">total number of files</span>&gt;.zip</code></p>
</li>
<li>
<p>Log in to the first node of the cluster as <code class="codeph">root</code>.</p>
</li>
<li>
<p>Extract all files from the all of the downloaded zip files. For example:</p>
<pre dir="ltr">
$ <span class="bold">unzip p&lt;patch_number&gt;_Linux-x86-64_1of4.zip</span>
        Archive:  p&lt;patch_number&gt;_&lt;version&gt;_Linux-x86-64_1of4.zip
  inflating: README.txt
   creating: BDAMammoth-ol6-&lt;version&gt;/
 ...
</pre></li>
<li>
<p>Change to the <code class="codeph">BDAMammoth-</code><span class="italic">&lt;<code class="codeph">version</code></span>&gt; directory:</p>
<pre dir="ltr">
# cd BDAMammoth-ol6-&lt;version&gt;
</pre></li>
<li>
<p>Extract all files from <code class="codeph">BDAMammoth-</code>&lt;<span class="italic"><code class="codeph">version</code></span>&gt;<code class="codeph">.run</code>:</p>
<pre dir="ltr">
# <span class="bold">./BDAMammoth-ol6-&lt;version&gt;.run</span>
 
Big Data Appliance Mammoth v&lt;version&gt; Self-extraction
 
Checking for and testing BDA Base Image in /tmp
 
BDABaseImage-&lt;version&gt;_RELEASE.iso: OK
 
Removing existing temporary files
 
Generating /tmp/BDAMammoth.tar
Verifying MD5 sum of /tmp/BDAMammoth.tar
/tmp/BDAMammoth.tar MD5 checksum matches
 
Extracting /tmp/BDAMammoth.tar to /opt/oracle/BDAMammoth
 
Extracting Base Image RPMs to bdarepo
Moving BDABaseImage into /opt/oracle/

Extracting BDA Extras
 
Removing temporary files
     .
     .
     .
Please "cd /opt/oracle/BDAMammoth" before running "./mammoth -i &lt;rack_name&gt;"
#
</pre>
<p>The new version of the Mammoth software is installed in <code class="codeph">/opt/oracle/BDAMammoth</code>, and the previous version (if you are upgrading) is saved in <code class="codeph">/opt/oracle/BDAMammoth/previous-BDAMammoth</code>.</p>
</li>
<li>
<p>Follow the specific instructions for the type of installation you are performing.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76660"></a>
<div class="props_rev_3"><a id="GUID-E6355C9C-BCE5-485A-80A0-DC80CFC36842"></a>
<h2 id="BIGOG-GUID-E6355C9C-BCE5-485A-80A0-DC80CFC36842" class="sect2"><span class="enumeration_section">10.4</span> Installing the Software on a New Rack</h2>
<div>
<p><a id="d43346e572" class="indexterm-anchor"></a><a id="d43346e576" class="indexterm-anchor"></a><a id="d43346e580" class="indexterm-anchor"></a>Mammoth installs and configures the software on Oracle Big Data Appliance using the files generated by Oracle Big Data Appliance Configuration Generation Utility. A cluster can be dedicated to either CDH (Hadoop) or Oracle NoSQL Database.</p>
<p>For a CDH cluster, Mammoth installs and configures Cloudera's Distribution including Apache Hadoop. This includes all the Hadoop software and Cloudera Manager, which is the tool for administering your Hadoop cluster. If you have a license, Mammoth optionally installs and configures all components of Oracle Big Data Connectors.</p>
<p>For a NoSQL cluster, Mammoth installs Oracle NoSQL Database. CDH and Oracle NoSQL Database do not share a cluster, beginning with Oracle Big Data Appliance 2.2.</p>
<p>In addition to installing the software across all servers in the rack, Mammoth creates the required user accounts, starts the correct services, and sets the appropriate configuration parameters. When it is done, you have a fully functional, highly tuned, up and running Hadoop cluster.</p>
</div>
<a id="BIGOG76661"></a>
<div class="props_rev_3"><a id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76"></a>
<h3 id="BIGOG-GUID-F372AB92-C9E3-4B59-832A-662504B25F76" class="sect3"><span class="enumeration_section">10.4.1</span> Installing the Software</h3>
<div>
<div class="section">
<p><a id="d43346e611" class="indexterm-anchor"></a><a id="d43346e615" class="indexterm-anchor"></a>Follow this procedure to install and configure the software on one or more Oracle Big Data Appliance racks. You can configure one cluster on multiple racks in a single installation.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To install the software:</p>
<ol>
<li>
<p>Verify that the Oracle Big Data Appliance rack is configured according to the custom network settings described in <code class="codeph">/opt/oracle/bda/network.json</code> (or, <code class="codeph">cluster-network.json</code>). If the rack is still configured to the factory default IP addresses, first perform the network configuration steps described in <span class="q">"<a href="configure.htm#GUID-0EFE7F4E-B14B-4D4F-A3A1-3C39C8ED39EF">Configuring the Network</a>."</span></p>
</li>
<li>
<p><a id="d43346e637" class="indexterm-anchor"></a>Verify that the software is not installed on the rack already. If the software is installed and you want to upgrade it, then use the <code class="codeph">mammoth -p</code> option in Step <a href="mammoth.htm#GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABBGAAB">6</a>.</p>
</li>
<li id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABCJHCC">
<p>Download and unzip the Mammoth bundle. You must be logged in as <code class="codeph">root</code> to the first server in the cluster.</p>
</li>
<li>
<p>Change to the <code class="codeph">BDAMammoth</code> directory.</p>
<pre dir="ltr">
# cd /opt/oracle/BDAMammoth
</pre></li>
<li>
<p>Copy <span class="italic"><code class="codeph">cluster_name</code></span><code class="codeph">-config.json</code> to the current directory.</p>
</li>
<li id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABBGAAB">
<p>Run the <code class="codeph">mammoth</code> command with the appropriate options. This sample command runs all steps:</p>
<pre dir="ltr">
./mammoth -i <span class="italic">rack_name</span>
</pre>
<p>After Mammoth completes Step 3 of the installation, it prompts you to restart, if it upgraded the base image.</p>
</li>
<li id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABHBDDA">
<p>If you installed support for Auto Service Request, then complete the steps in <span class="q">"<a href="mammoth.htm#GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABFHAEC">Verifying the Auto Service Request Installation</a>."</span></p>
</li>
<li id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABGABFJ">
<p>To configure another CDH cluster on the server:</p>
<ol>
<li>
<p>Copy the BDAMammoth ZIP file to any directory on the first server of the cluster, which is either server 7 or server 13.</p>
</li>
<li>
<p>Repeat Steps <a href="mammoth.htm#GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABCJHCC">3</a> to <a href="mammoth.htm#GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABHBDDA">7</a>. Each cluster has its own <span class="italic"><code class="codeph">cluster_name</code></span><code class="codeph">-config.json</code> file. Oracle Big Data Appliance Configuration Generation Utility creates the files in separate directories named for the clusters.</p>
</li>
</ol>
</li>
</ol>
<div class="infoboxnotealso" id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__GUID-4FC6EE5E-004D-4ABA-B214-CD73135CACB5">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">"<a href="mammoth.htm#GUID-29022554-078A-4E5F-9868-4AD9AF3858AA">Downloading the Mammoth Software Deployment Bundle</a>"</span></p>
</li>
<li>
<p><span class="q">"<a href="configurator.htm#GUID-FFE4B6CD-BD89-4566-897B-F32451D6C11F">About the Configuration Files</a>"</span></p>
</li>
<li>
<p><span class="q">"<a href="mammoth.htm#GUID-2C9C6188-2D32-41C0-9BE7-098109B7416F">Mammoth Software Installation and Configuration Utility</a>."</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section">
<div class="infobox-note" id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__GUID-C180F678-4F0D-4777-813F-19506177251F">
<p class="notep1">Note:</p>
<p>Mammoth stores the current configuration in the <code class="codeph">/opt/oracle/bda/install/state</code> directory. <span class="italic">Do not delete the files in this directory.</span> Mammoth fails without this information if you must use it again, such as adding a rack to the cluster.</p>
</div>
</div>
<!-- class="section" -->
<div class="section" id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABFHAEC">
<p class="subhead3">Verifying the Auto Service Request Installation</p>
<ol>
<li>
<p><a id="d43346e745" class="indexterm-anchor"></a>Log in to My Oracle Support at <a href="http://support.oracle.com" target="_blank"><code class="codeph">http://support.oracle.com</code></a>.</p>
</li>
<li>
<p>Search for document ID 2103715.1, <span class="italic">Engineered Systems ASR Configuration Check tool (asrexacheck version 4.x)</span>, and download the <a id="d43346e761" class="indexterm-anchor"></a><code class="codeph">asrexacheck</code> script.</p>
<p>Although this check was originally intended for Oracle Exadata Database Machine, it is now supported on Oracle Big Data Appliance.</p>
</li>
<li>
<p>Copy <code class="codeph">asrexacheck</code> to a server in the Oracle Big Data Appliance cluster.</p>
</li>
<li>
<p>Log in to the server as <code class="codeph">root</code>.</p>
</li>
<li>
<p>Copy <code class="codeph">asrexacheck</code> to all servers in the cluster:</p>
<pre dir="ltr">
# dcli -C -f asrexacheck -d /opt/oracle.SupportTools
</pre></li>
<li>
<p>Change the file access permissions:</p>
<pre dir="ltr">
# dcli -C chmod 755 /opt/oracle.SupportTools/asrexacheck
</pre></li>
<li>
<p>Run the script:</p>
<pre dir="ltr">
# dcli -C /opt/oracle.SupportTools/asrexacheck
</pre></li>
<li>
<p>File an Oracle Support Request (SR) to validate the ASR installation. Note the following choices:</p>
<ol>
<li>
<p>Under "What is the Problem?" click the Hardware tab.</p>
</li>
<li>
<p>For Products Grouped By, select Hardware License.</p>
</li>
<li>
<p>For Problem Type, select My - Auto Service Request (ASR) Installation and Configuration Issues.</p>
</li>
<li>
<p>Include the output of <code class="codeph">asrexacheck</code>.</p>
</li>
</ol>
</li>
<li>
<p>Continue with Step <a href="mammoth.htm#GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABGABFJ">8</a> of the software installation procedure.</p>
</li>
</ol>
<div class="infoboxnotealso" id="GUID-F372AB92-C9E3-4B59-832A-662504B25F76__GUID-92A81933-8824-4F0A-B3FE-DB586C2E1482">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>For information about <code class="codeph">dcli</code>:
<p><a href="dcli.htm#GUID-ED09B97C-BAAE-41E1-A7D0-A65BF1E8AF8F">Executing Commands Across a Cluster Using the dcli Utility</a></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BIGOG76664"></a>
<div class="props_rev_3"><a id="GUID-C9A914CE-524B-4EF4-9EDF-13D768530195"></a>
<h2 id="BIGOG-GUID-C9A914CE-524B-4EF4-9EDF-13D768530195" class="sect2"><span class="enumeration_section">10.5</span> What If an Error Occurs During the Installation?</h2>
<div>
<div class="section">
<p>If the Mammoth utility fails, take these steps to resolve the problem:</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Read the error message to see if it suggests a cause or a resolution.</span></li>
<li class="stepexpand"><span>Make the recommended changes and rerun the step.</span></li>
<li class="stepexpand"><span>If the error message does not recommend a resolution, or it does not resolve the problem:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>File a service request (SR) with My Oracle Support.</p>
</li>
<li>
<p>Upload the diagnostic zip file, which Mammoth generates when an error occurs.</p>
</li>
</ul>
</div>
</li>
</ol>
<div class="section">
<div class="infoboxnotealso" id="GUID-C9A914CE-524B-4EF4-9EDF-13D768530195__GUID-D9102046-2E27-47AE-B09C-B08009E9938A">
<p class="notep1">See Also:</p>
<p><a class="olink BIGUG248" target="_blank" href="../BIGUG/admin.htm#BIGUG248"><span class="italic">Oracle Big Data Appliance Software User's Guide</span></a></p>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5"></a>
<h2 id="BIGOG-GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5" class="sect2"><span class="enumeration_section">10.6</span> Adding Servers to a Cluster</h2>
<div>
<div class="section">
<p><a id="d43346e921" class="indexterm-anchor"></a><a id="d43346e923" class="indexterm-anchor"></a><a id="d43346e925" class="indexterm-anchor"></a><a id="d43346e929" class="indexterm-anchor"></a><a id="d43346e933" class="indexterm-anchor"></a>To add servers to an existing cluster, use the Mammoth Utility to extend the cluster onto the new servers. Do not use the Oracle Big Data Appliance Configuration Generation Utility for this purpose.</p>
<p>For each rack in a cluster, the minimum number of servers that the rack can contribute to the cluster is three. Therefore, initially you must add a group of at least three. After the minimum number is fulfilled, there are no further constraints. You can then add more servers from the rack to the cluster individually or in groups of any number. You can also extend the cluster to all of the servers on the rack at the same time.</p>
<p>If you are adding servers to same rack (and to the same cluster) then there is no cluster downtime for the process. The first time a single-rack cluster is extended onto a second rack, there will be downtime for the cluster extension (as master roles are moved to the additional rack) but subsequent cluster extensions will not require any downtime.</p>
<p>It is&nbsp;not necessary to decommission edge nodes when adding&nbsp;new nodes to an existing cluster.</p>
<p>There is no significant difference between how new server nodes and old nodes are configured. However, when a new node has a larger disk capacity, the data partitions created are correspondingly larger in order to use the entire disk. HDFS handles the fact that some data nodes have more space available than other nodes. Oracle Big Data Appliance performs no additional special configuration.</p>
<div class="infoboxnotealso" id="GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5__GUID-52B66C03-CB9F-41C1-B32A-075DEDE97E82">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">"<a href="mammoth.htm#GUID-FD6DE509-12FA-4CE5-A454-DF61AE04C19B">About Rolling Upgrades</a>"</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To install the software on additional servers in a cluster:</p>
<div class="infobox-note" id="GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5__GUID-B929699B-35C6-42C4-82CC-76626E06A8F2">
<p class="notep1">Before You Start:</p>
<ul style="list-style-type: disc;">
<li>
<p>See <span class="q">"<a href="mammoth.htm#GUID-2C9C6188-2D32-41C0-9BE7-098109B7416F">Mammoth Software Installation and Configuration Utility</a>"</span> for an explanation of the Mammoth <code class="codeph">-e</code> option.</p>
</li>
</ul>
</div>
<ol>
<li>
<p>Ensure that all servers are running the same software version. The additional servers must not have an Oracle Big Data Appliance base image that is newer than the existing cluster.</p>
</li>
<li>
<p>Ensure that all racks that form a single Hadoop cluster are cabled together.</p>
</li>
<li>
<p>Connect as <code class="codeph">root</code> to node01 of the primary rack and change to the <code class="codeph">BDAMammoth</code> directory:</p>
<pre dir="ltr">
cd /opt/oracle/BDAMammoth
</pre>
<p><span class="bold">Note</span>: Always start Mammoth from the primary rack.</p>
</li>
<li>
<p>Generate a parameter file for the server group. The following example adds six servers beginning with node13:</p>
<pre dir="ltr">
./mammoth -e node13 node14 node15 node16 node17 node18
</pre>
<p>The servers can be on the same rack or multiple racks.</p>
<p>After Mammoth completes Step 3 of the installation, it prompts you to restart, if it upgraded the base image.</p>
</li>
<li>
<p>If you are using <a id="d43346e1002" class="indexterm-anchor"></a>Oracle Enterprise Manager Cloud Control to monitor Oracle Big Data Appliance, then run rediscovery to identify the hardware and software changes.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p>If you have a license for <a id="d43346e1010" class="indexterm-anchor"></a><a id="d43346e1014" class="indexterm-anchor"></a>Oracle Big Data Connectors, then they are installed on all nodes of the non-primary racks, although the services do not run on them. Oracle Data Integrator agent still runs on node03 of the primary rack.</p>
<p>Mammoth obtains the current configuration from the files stored in <code class="codeph">/opt/oracle/bda/install/state</code>. If those files are missing or if any of the services have been moved manually to run on other nodes, then <a id="d43346e1024" class="indexterm-anchor"></a>Mammoth fails.</p>
<div class="infoboxnotealso" id="GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5__GUID-D1E1CF41-D626-4F71-A12D-172E9D6DD1DC">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">"<a href="mammoth.htm#GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5__BABBAAHJ">About Software Version Differences</a>"</span></p>
</li>
<li>
<p><span class="q">"<a href="hardware.htm#GUID-621F1684-9BC9-41B0-9BE8-E5F88F5782CA">Connecting Multiple Oracle Big Data Appliance Racks</a>"</span></p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section" id="GUID-4B64DAA8-9624-484D-9B55-D2F09B2629C5__BABBAAHJ">
<p class="subhead2">About Software Version Differences</p>
<p>All servers configured as one Hadoop cluster must have the same image. A new Oracle Big Data Appliance rack might be factory-installed with a newer base image than the previously installed racks. Use the <a id="d43346e1046" class="indexterm-anchor"></a><code class="codeph">imageinfo</code> utility on any server to get the image version. When all servers of a single Hadoop cluster have the same image version, you can install the software.</p>
<p>To synchronize the new servers with the rest of the Hadoop cluster, either upgrade the existing cluster to the latest image version or downgrade the image version of the new servers.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To upgrade the image version:</p>
<ul style="list-style-type: disc;">
<li>
<p>Run Mammoth with the <code class="codeph">-p</code> option to upgrade the software on the cluster to the latest version. See <span class="q">"<a href="mammoth.htm#GUID-35C6A18E-94E1-40B7-9193-F461D5AFCBC0" title="Oracle one-off patches for Oracle Big Data Appliance software are by definition supported.&nbsp;Parcel upgrades that are not part of a one-off patch are unsupported unless affirmed by Oracle Support.">Upgrading the Software on Oracle Big Data Appliance</a>."</span></p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To downgrade the image version:</p>
<ul style="list-style-type: disc;">
<li>
<p>Reimage the new rack to the older version installed on the cluster. See My Oracle Support Information Center ID 1445745.2.</p>
</li>
<li>
<p>Use the old version of the Mammoth utility, which is on the first server of the existing cluster, to extend the cluster onto the new rack.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p>If you add a newer server model, then you can downgrade only to the first software version available for that model. For example, if you add Sun Server X3-2L servers, then you must install Oracle Big Data Appliance software version 2.3 or higher.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76762"></a>
<div class="props_rev_3"><a id="GUID-35C6A18E-94E1-40B7-9193-F461D5AFCBC0"></a>
<h2 id="BIGOG-GUID-35C6A18E-94E1-40B7-9193-F461D5AFCBC0" class="sect2"><span class="enumeration_section">10.7</span> Upgrading the Software on Oracle Big Data Appliance</h2>
<div>
<p>The procedure for upgrading the software is the same whether you are upgrading from one major release to another or just applying a patch set. The procedure is also the same whether your Hadoop cluster consists of one Oracle Big Data Appliance rack or multiple racks.</p>
<p>The process upgrades all components of the software stack including the firmware, Oracle Linux Unbreakable Enterprise Kernel (UEK), CDH, JDK, and Oracle Big Data Connectors (if previously installed).</p>
<p>To upgrade only Oracle Big Data Connectors, and no other components of the software stack, contact Oracle Support for assistance.</p>
<p>Software downgrades are not supported.</p>
<div class="infobox-note" id="GUID-35C6A18E-94E1-40B7-9193-F461D5AFCBC0__GUID-441638FD-7FBD-47FB-85D7-5E06E4D3DD13">
<p class="notep1">Note:</p>
<p>The upgrade will prompt you to either choose a rolling upgrade or to continue with a conventional upgrade. A conventional upgrade process automatically stops and starts services as needed. Therefore the cluster is unavailable while the <code class="codeph">mammoth</code> command is executing. The advantage of a rolling upgrade is that it may allow uninterrupted access to some services throughout the upgrade process. However, a rolling upgrade adds some extra time per server because the reboots are not concurrent.</p>
</div>
<p>Currently, Oracle Big Data Appliance software upgrades do not require corresponding upgrades of the InfiniBand or Cisco switches.</p>
</div>
<a id="BIGOG76962"></a>
<div class="props_rev_3"><a id="GUID-DCC0E7D3-31AD-48AA-924A-12063C6BD1BE"></a>
<h3 id="BIGOG-GUID-DCC0E7D3-31AD-48AA-924A-12063C6BD1BE" class="sect3"><span class="enumeration_section">10.7.1</span> About the Operating System Versions</h3>
<div>
<p>Oracle Big Data Appliance 4.11 supports Oracle Linux 6 only, for both installations and upgrades. Oracle Linux 5 is not supported. Oracle Linux 7 support will be added in a future release.</p>
</div>
</div>
<a id="BIGOG76827"></a>
<div class="props_rev_3"><a id="GUID-E54BC906-D6A1-4903-A73D-198393784C89"></a>
<h3 id="BIGOG-GUID-E54BC906-D6A1-4903-A73D-198393784C89" class="sect3"><span class="enumeration_section">10.7.2</span> Upgrading the Software</h3>
<div>
<div class="section">
<p>Follow these procedures to upgrade the software on an Oracle Big Data Appliance cluster to the current version.</p>
</div>
<!-- class="section" --></div>
<a id="BIGOG76963"></a>
<div class="props_rev_3"><a id="GUID-295AB4B3-CC16-4D90-A504-FC1E7C2D00DA"></a>
<h4 id="BIGOG-GUID-295AB4B3-CC16-4D90-A504-FC1E7C2D00DA" class="sect4"><span class="enumeration_section">10.7.2.1</span> Prerequisites</h4>
<div>
<p>You must know the passwords currently in effect for the cluster, which the Mammoth utility will prompt you for:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">oracle</code></p>
</li>
<li>
<p><code class="codeph">root</code></p>
</li>
<li>
<p>Cloudera Manager <code class="codeph">admin</code></p>
</li>
<li>
<p>MySQL Database <code class="codeph">admin</code></p>
</li>
<li>
<p>MySQL Database for Oracle Data Integrator (if Oracle Data Integrator agent is installed)</p>
</li>
</ul>
<p>In Oracle Big Data Appliance 4.1, Apache Sentry changed from a file-based provider to the Sentry service. If Sentry as a file-based provider was enabled when you upgrade the cluster, then the file-based provider is retained. To switch to the Sentry service, disable Sentry before you upgrade the software, and then re-enable Sentry afterward.</p>
</div>
</div>
<a id="BIGOG76964"></a>
<div class="props_rev_3"><a id="GUID-232DF034-7BB6-4581-98F9-E4F0C2DEDE4A"></a>
<h4 id="BIGOG-GUID-232DF034-7BB6-4581-98F9-E4F0C2DEDE4A" class="sect4"><span class="enumeration_section">10.7.2.2</span> Upgrading to the Current Software Version</h4>
<div>
<div class="section">Making sure cluster services are healthy before upgrade, and especially after reboot is very important.&nbsp; This is even more important in the case of rolling upgrade.&nbsp; In the case of rolling upgrade, if previous errors exist, the parcel upgrade will stop (even if the parcel is already upgraded).&nbsp; This will prevent services from starting. Manual steps will be needed to resume.
<p>Upgrade the Oracle Big Data Appliance software to the current software version as follows. This is a summary. Refer to Doc ID 2101906. in <a href="https://support.oracle.com/" target="_blank">My Oracle Support</a> for details, including prerequisites, further information on the steps below, and known issues.</p>
<div class="infobox-note" id="GUID-232DF034-7BB6-4581-98F9-E4F0C2DEDE4A__GUID-DB349274-0356-4A9B-9CAB-049F82CE9796">
<p class="notep1">Important:</p>
Stop all Oozie jobs before the upgrade. Failure to do this may cause the upgrade to fail.</div>
<p>In the upgrade, Spark 2 is automatically deployed on clusters where it is not already present.</p>
</div>
<!-- class="section" -->
<ol>
<li class="stepexpand"><span>Download and unzip the Mammoth bundle, as described in <span class="q">"<a href="mammoth.htm#GUID-29022554-078A-4E5F-9868-4AD9AF3858AA">Downloading the Mammoth Software Deployment Bundle</a>."</span> You must be logged in as <code class="codeph">root</code> to node 1 of the primary rack.</span></li>
<li class="stepexpand"><span>Change to the <code class="codeph">BDAMammoth</code> directory.</span>
<div>
<pre dir="ltr">
# cd /opt/oracle/BDAMammoth
</pre></div>
</li>
<li class="stepexpand"><span>Run the <code class="codeph">mammoth</code> command with the <code class="codeph">-p</code> option:</span>
<div>
<pre dir="ltr">
# ./mammoth -p
</pre>
<p>Mammoth automatically upgrades the base image if necessary.</p>
</div>
</li>
<li class="stepexpand"><span>After all nodes reboot, perform the following checks.</span>
<ol>
<li class="substepexpand"><span>Check uptime.</span>
<div><code class="codeph"># dcli -C uptime</code></div>
</li>
<li class="substepexpand"><span>Check <code>/root/BDA_REBOOT_SUCCEEDED</code>.</span>
<div><code class="codeph"># dcli -C ls -ltr /root/BDA_REBOOT_SUCCEEDED</code></div>
<div><span class="bold">Note:</span> If there is no <code>BDA_REBOOT_SUCCEEDED</code>, check for <code>/root/BDA_REBOOT_*</code> and <code>/root/bda_reboot_status</code>.</div>
</li>
<li class="substepexpand"><span>Verify that the kernel and JDK are upgraded.</span>
<div>
<pre dir="ltr">
# dcli -C uname -a 
# dcli -C java -version
</pre></div>
</li>
<li class="substepexpand"><span>Check that all Cloudera Configuration Manager services are healthy. You may need to manually restart some services.</span>
<div>
<div class="infobox-note" id="GUID-232DF034-7BB6-4581-98F9-E4F0C2DEDE4A__GUID-4CB3F10C-8DDA-42C0-BD59-71D6650053C9">
<p class="notep1">Note:</p>
During any upgrade, but especially a rolling upgrade, it is <span class="bold">crucial that all services in CM are healthy after the reboot before continuing</span>.&nbsp; Failure to do so will result in upgrade failures.</div>
</div>
</li>
</ol>
</li>
<li class="stepexpand"><span>After the reboot and the post reboot checks, log on to node 1 of the primary rack and rerun <code class="codeph">mammoth -p</code> in order to resume the upgrade.</span>
<div>
<pre dir="ltr">
# cd /opt/oracle/BDAMammoth
# ./mammoth -p
</pre></div>
</li>
<li class="stepexpand"><span>When the upgrade is complete, perform the post-upgrade validation steps described in the MOS document (2101906.1).</span></li>
</ol>
</div>
</div>
<div class="sect4"><a id="GUID-E4395F51-AD76-42A4-84C6-BEA372A1751F"></a>
<h4 id="BIGOG-GUID-E4395F51-AD76-42A4-84C6-BEA372A1751F" class="sect4"><span class="enumeration_section">10.7.2.3</span> Performing Parcel Upgrades Outside of the One-Off Patch Mechanism</h4>
<div>
<p>Oracle one-off patches for Oracle Big Data Appliance software are by definition supported.&nbsp;Parcel upgrades that are not part of a one-off patch are unsupported unless affirmed by Oracle Support.</p>
<p>Mammoth bundles include a recent version of the parcel for Cloudera's Distribution including Apache Hadoop (CDH). However, CDH is released on Cloudera&rsquo;s schedule and sometimes a newer CDH release than the one in the current Mammoth bundle may be available. A new CDH version may be supported for integration with the current Oracle Big Data Appliance release. Consult with Oracle Support if you have questions.</p>
</div>
</div>
</div>
</div>
<a id="BIGOG76772"></a>
<div class="props_rev_3"><a id="GUID-D9B445F2-A5DD-4C6C-9BA1-2F5330ED4798"></a>
<h2 id="BIGOG-GUID-D9B445F2-A5DD-4C6C-9BA1-2F5330ED4798" class="sect2"><span class="enumeration_section">10.8</span> Changing the Configuration of Optional Software</h2>
<div>
<p>During the initial configuration of Oracle Big Data Appliance, the optional software components may or may not be installed. Using the <code class="codeph">bdacli</code> utility, you can reverse some of those decisions. You must provide the relevant server names, ports, user names, and passwords.</p>
<p>This section provides examples of some reconfiguration options. It has the following topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="mammoth.htm#GUID-DCA05BF1-0E4B-4907-A42D-E0B0B3D12E62">Changing Support for Oracle Big Data Connectors</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-B43325C5-FC4C-4152-9F53-96D2B8064A84">Adding Support for Auto Service Request</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-FC7CF4DA-5665-4E9D-8250-72BC8A4A36B2">Adding Support for Oracle Enterprise Manager Cloud Control</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-9AEAD5C7-EC41-4686-99A8-A289939F530B">Adding Kerberos Authentication</a></p>
</li>
</ul>
<div class="infobox-note" id="GUID-D9B445F2-A5DD-4C6C-9BA1-2F5330ED4798__GUID-C7D9B940-019A-442F-BE1D-1B959B8A2EB9">
<p class="notep1">Note:</p>
<p>See <span class="q">"<a href="utilities.htm#GUID-685D1923-EC2A-42B6-8D97-1DFB8239D57C">bdacli</a>"</span> for the complete syntax.</p>
</div>
</div>
<a id="BIGOG77001"></a>
<div class="props_rev_3"><a id="GUID-DCA05BF1-0E4B-4907-A42D-E0B0B3D12E62"></a>
<h3 id="BIGOG-GUID-DCA05BF1-0E4B-4907-A42D-E0B0B3D12E62" class="sect3"><span class="enumeration_section">10.8.1</span> Changing Support for Oracle Big Data Connectors</h3>
<div>
<p>You can add or remove support for Oracle Big Data Connectors:</p>
</div>
<a id="BIGOG77002"></a>
<div class="props_rev_3"><a id="GUID-112130AE-A94F-44CE-ACDD-4E8447C7E504"></a>
<h4 id="BIGOG-GUID-112130AE-A94F-44CE-ACDD-4E8447C7E504" class="sect4"><span class="enumeration_section">10.8.1.1</span> Adding Oracle Big Data Connectors</h4>
<div>
<div class="section">
<p>When adding support for Oracle Big Data Connectors, you can choose whether to install Oracle Data Integrator agent. If you do, then you must provide passwords for the MySQL Database root user and the Oracle Data Integrator user of MySQL Database (<code class="codeph">BDA_ODI_REPO</code>). You must also know the password for the Cloudera Manager admin user if it is not saved in <span class="italic"><code class="codeph">cluster_name</code></span><code class="codeph">-config.json</code>:</p>
</div>
<!-- class="section" -->
<div class="section">
<p>The following procedure uses the <code class="codeph">bdacli</code> utility.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To add Oracle Big Data Connectors to a cluster:</p>
<ol>
<li>
<p>Log in to the first NameNode (node01) of the primary rack as <code class="codeph">root</code>.</p>
</li>
<li>
<p>Enable Oracle Big Data Connectors:</p>
<pre dir="ltr">
# <span class="bold">bdacli enable bdc</span>
INFO: Logging all actions in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node03-20140805110007.log and traces in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node03-20140805110007.trc
INFO: This is the install of the primary rack
INFO: Checking if password-less ssh is set up
     .
     .
     .
Do you wish to enable ODI? [y/n]: <span class="bold">y</span>
Enter password for the BDA_ODI_REPO mysql user
Enter password: <span class="italic"><span class="bold">odi_password</span></span>
Enter password again: <span class="italic"><span class="bold">odi_password</span></span>
Enter password for the mysql root user
Enter password: <span class="italic"><span class="bold">root_password</span></span>
Enter password again: <span class="italic"><span class="bold">root_password</span></span>
WARNING: The password for the Cloudera Manager admin user is missing from the parameters file and is required for the installation.
Enter password: <span class="italic"><span class="bold">admin_password</span></span>
Enter password again: <span class="italic"><span class="bold">admin_password</span></span>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     2    0     2    0     0    181      0 --:--:-- --:--:-- --:--:--   250
INFO: Creating environment.pp file ...
INFO: Making sure all puppet agents can be accessed.
INFO: Pinging puppet agents
INFO: Adding BDC to the cluster. This will take some time ...
     .
     .
     .
SUCCESS: Successfully reconfigured service
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG77003"></a>
<div class="props_rev_3"><a id="GUID-FDE55707-C297-49D5-B824-92F658625871"></a>
<h4 id="BIGOG-GUID-FDE55707-C297-49D5-B824-92F658625871" class="sect4"><span class="enumeration_section">10.8.1.2</span> Removing Oracle Big Data Connectors</h4>
<div>
<div class="section">
<p>When removing support for Oracle Big Data Connectors, you must provide passwords for the following users, if the passwords are not saved in <span class="italic"><code class="codeph">cluster_name</code></span><code class="codeph">-config.json</code>:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p>Cloudera Manager admin user</p>
</li>
<li>
<p>MySQL Database root user, if Oracle Data Integrator agent is enabled</p>
</li>
<li>
<p>BDA_ODI_REPO user of MySQL Database, if Oracle Data Integrator agent is enabled</p>
</li>
</ul>
<p>The following procedure uses the <code class="codeph">bdacli</code> utility.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To remove Oracle Big Data Connectors from a cluster:</p>
<ol>
<li>
<p>Log in to the first NameNode (node01) of the primary rack as <code class="codeph">root</code>.</p>
</li>
<li>
<p>Remove Oracle Big Data Connectors:</p>
<pre dir="ltr">
# <span class="bold">bdacli disable bdc</span>
INFO: Logging all actions in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node03-20140805104603.log and traces in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node03-20140805104603.trc
INFO: This is the install of the primary rack
INFO: Checking if password-less ssh is set up
INFO: Executing checkRoot.sh on nodes 
 
/opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
SUCCESS: Executed checkRoot.sh on nodes 
 
/opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
INFO: Executing checkSSHAllNodes.sh on nodes 
 
/opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
SUCCESS: Executed checkSSHAllNodes.sh on nodes 
 
/opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
INFO: Reading component versions from 
 
/opt/oracle/BDAMammoth/bdaconfig/COMPONENTS
INFO: Creating nodelist files...
WARNING: The password for the Cloudera Manager admin user is missing from the parameters file and is required for the installation.
Enter password: <span class="italic"><span class="bold">admin_password</span></span>
Enter password again: <span class="italic"><span class="bold">admin_password</span></span>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     2    0     2    0     0    184      0 --:--:-- --:--:-- --:--:--   250
WARNING: The password for the MySQL root user is missing from the parameters file and is required for the installation.
Enter password: <span class="italic"><span class="bold">root_password</span></span>
Enter password again: <span class="italic"><span class="bold">root_password</span></span>
INFO: Executing verifyMySQLPasswd.sh on nodes 
/opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
SUCCESS: Executed verifyMySQLPasswd.sh on nodes 
 
/opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
WARNING: The password for the MySQL BDA_ODI_REPO user is missing from the  parameters file and is required for the installation.
Enter password: <span class="italic"><span class="bold">odi_password</span></span>
Enter password again: <span class="italic"><span class="bold">odi_password</span></span>
INFO: Executing verifyMySQLPasswd.sh on nodes 
/opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
INFO: Creating environment.pp file ...
INFO: Making sure all puppet agents can be accessed.
INFO: Pinging puppet agents
INFO: Removing big data connectors. This will take some time ...
     .
     .
     .
SUCCESS: Successfully reconfigured service
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BIGOG76953"></a>
<div class="props_rev_3"><a id="GUID-B43325C5-FC4C-4152-9F53-96D2B8064A84"></a>
<h3 id="BIGOG-GUID-B43325C5-FC4C-4152-9F53-96D2B8064A84" class="sect3"><span class="enumeration_section">10.8.2</span> Adding Support for Auto Service Request</h3>
<div>
<div class="section">
<p>The following procedure shows how to add support for <a id="d43346e1614" class="indexterm-anchor"></a>Auto Service Request.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To support Auto Service Request:</p>
<ol>
<li>
<p>Set up your My Oracle Support account and install ASR Manager. You must do this before activating Auto Service Request on Oracle Big Data Appliance. See <a href="asr.htm#GUID-6D1BCF7C-FCDD-4767-A10C-BD5519C3EF6A">Setting Up Auto Service Request</a>.</p>
</li>
<li>
<p>Turn on Auto Service Request monitoring and activate the assets:</p>
<pre dir="ltr">
# <span class="bold">bdacli enable asr</span>
INFO: Logging all actions in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node01-20130205075303.log and traces in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node01-20130205075303.trc
     .
     .
     .
Enter the value for ASR_HOST [Default: ]: <span class="bold">asr-host.example.com</span>
Enter the value for ASR_PORT [Default: <span class="bold">162</span>]:
Enter the value for ASR_SERVER_USER: <span class="bold">jdoe</span>
 
Please Check the values you entered for the ASR parameters
 
ASR_HOST = asr-host.example.com
ASR_PORT = 162
ASR_SERVER_USER = jdoe
 
Are these values correct (y/n): <span class="bold">y</span>
Enter password for user jdoe on machine asr-host.example.com
Enter password: <span class="italic"><span class="bold">password</span></span>
Enter password again: <span class="italic"><span class="bold">password</span></span>
INFO: Creating environment.pp file ...
INFO: Making sure all puppet agents can be accessed.
INFO: Pinging puppet agents
INFO: Setting up ASR on all nodes. This will take some time ...
     .
     .
     .
</pre></li>
<li>
<p>Complete the steps in <span class="q">"<a href="mammoth.htm#GUID-F372AB92-C9E3-4B59-832A-662504B25F76__BABFHAEC">Verifying the Auto Service Request Installation</a>."</span></p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76954"></a>
<div class="props_rev_3"><a id="GUID-FC7CF4DA-5665-4E9D-8250-72BC8A4A36B2"></a>
<h3 id="BIGOG-GUID-FC7CF4DA-5665-4E9D-8250-72BC8A4A36B2" class="sect3"><span class="enumeration_section">10.8.3</span> Adding Support for Oracle Enterprise Manager Cloud Control</h3>
<div>
<div class="section">Oracle Big Data Appliance supports these versions of the Enterprise Manager System Monitoring plug-in: 13.2 PG, 13.2, 13.1, and 12.c. You can install the Enterprise Manager System Monitoring plug-in for Oracle Big Data Appliance in an Oracle Enterprise Manager Cloud Control installation on the same network. <a id="d43346e1686" class="indexterm-anchor"></a></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Installing the Oracle Enterprise Manager Cloud Control Plug-In</p>
<ol>
<li>
<p>Install the preliminary patches (if required for the plug-in version you choose).</p>
<div class="p">To enable system monitoring over HTTPS for either the 13.1 or 12.c plug-in, you must first install the patches listed in the table below. You can download these patches from the Oracle Automated Release Updates (ARU) site. the 13.2 and 13.2PG plug-ins do not require additional patches.
<div class="tblformal" id="GUID-FC7CF4DA-5665-4E9D-8250-72BC8A4A36B2__GUID-7A205A31-5E61-4B47-986E-26DE79F4AA66">
<table class="cellalignment224">
<thead>
<tr class="cellalignment165">
<th class="cellalignment267" id="d43346e1705">Enterprise Manager System Monitoring Plug-In</th>
<th class="cellalignment267" id="d43346e1707">Patch Prerequisites for Support of the Plug-In on Oracle Big Data Appliance</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment165">
<td class="cellalignment165" id="d43346e1711" headers="d43346e1705">13.2 and 13.2 PG Enterprise Manager System Monitoring Plug-Ins.
<p>For Oracle Big Data Appliance, the specific 13.2 PG version is <code class="codeph">Enterprise Manager for Big Data Appliance (13.2.2.0.0)</code>.</p>
</td>
<td class="cellalignment165" headers="d43346e1711 d43346e1707">No patches needed.</td>
</tr>
<tr class="cellalignment165">
<td class="cellalignment165" id="d43346e1721" headers="d43346e1705">13.1 Enterprise Manager System Monitoring Plug-In</td>
<td class="cellalignment165" headers="d43346e1721 d43346e1707">
<ul style="list-style-type: disc;">
<li>
<p>OMS side patch: 23294904</p>
</li>
<li>
<p>Agent plugin : 23294778</p>
</li>
<li>
<p>Discovery plugin : 23294785</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment165">
<td class="cellalignment165" id="d43346e1735" headers="d43346e1705">12.c Enterprise Manager System Monitoring Plug-In</td>
<td class="cellalignment165" headers="d43346e1735 d43346e1707">&nbsp;&nbsp;&nbsp;
<ul style="list-style-type: disc;">
<li>
<p>OMS side patch: 23218275</p>
</li>
<li>
<p>BDA Plugin Discovery OH patches: 23218115 and 23218109.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</li>
<li>
<p>Install the Enterprise Manager System Monitoring plug-in.</p>
<p>For instructions on installing the version 13.1 plug-in, see <a class="olink EMBDA-GUID-55CA2EC0-2A3B-446A-9314-51E6B83D69FA" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=EMBDA-GUID-55CA2EC0-2A3B-446A-9314-51E6B83D69FA"><span class="italic">Oracle Enterprise Manager System Monitoring Plug-in Installation Guide for Oracle Big Data Appliance</span></a> . You can use these same instructions to install version 13.2 and 13.2 PG.</p>
<p>For instructions on installing the 12.c plug-in, see this My Oracle Support Document:<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=393639135990630&amp;id=2148611.1&amp;_adf.ctrl-state=5kwma4oke_77" target="_blank"><span class="italic">Download/Deployment of the 12c EM May Bundle Patch to Support Discovery/Monitoring&nbsp;of Cloudera Manager Admin Console HTTPS URLS (Doc ID 2148611.1)</span></a>.</p>
</li>
</ol>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">What&rsquo;s New in 13.2 PG for Oracle Big Data Appliance?</p>
<p>The 13.2 PG&nbsp;plug-in for Oracle Big Data Appliance adds support for the following targets:</p>
<ul style="list-style-type: disc;">
<li>
<p>Kafka</p>
</li>
<li>
<p>Sentry</p>
</li>
<li>
<p>Sqoop2</p>
</li>
<li>
<p>Key Management Service</p>
</li>
<li>
<p>Key Trustee Service</p>
</li>
<li>
<p>Cluster Security</p>
</li>
</ul>
<div class="infoboxnotealso" id="GUID-FC7CF4DA-5665-4E9D-8250-72BC8A4A36B2__GUID-929C72BB-B0EF-4460-B433-12B696DEE0A4">
<p class="notep1">See Also:</p>
<p>See the following note in My Oracle Support for a cross-reference of Oracle Big Data Appliance releases and compatible Oracle Enterprise Manager plug-ins.</p>
<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=429477216293935&amp;id=2267589.1&amp;_adf.ctrl-state=y7n8zi1g7_77" target="_blank">Oracle Enterprise Manager Cloud Control Big Data Appliance Plug-In Compatibility Matrix for BDA V4.5 and Higher (Doc ID 2267589.1)</a></div>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76966"></a>
<div class="props_rev_3"><a id="GUID-9AEAD5C7-EC41-4686-99A8-A289939F530B"></a>
<h3 id="BIGOG-GUID-9AEAD5C7-EC41-4686-99A8-A289939F530B" class="sect3"><span class="enumeration_section">10.8.4</span> Adding Kerberos Authentication</h3>
<div>
<div class="section">
<p>The following procedure configures <a id="d43346e1817" class="indexterm-anchor"></a>Kerberos authentication.</p>
<div class="infobox-note" id="GUID-9AEAD5C7-EC41-4686-99A8-A289939F530B__GUID-3E1F0FA9-1DBE-4534-8101-78384787CC06">
<p class="notep1">Note:</p>
If you choose to enable Active Directory Kerberos, first read MOS (My Oracle Support) documents 2029378.1 and 2013585.1. These documents explain required preliminary steps and provide important information on known issues.</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To support Kerberos authentication:</p>
<ol>
<li>
<p>Ensure that you complete the Kerberos prerequisites listed in <span class="q">"<a href="mammoth.htm#GUID-5D0B03C7-7205-4752-BBB9-CFBD69EFD109">Installation Prerequisites</a>."</span></p>
</li>
<li>
<p>Log into the first NameNode (node01) of the primary rack.</p>
</li>
<li>
<p>Configure Kerberos:</p>
<pre dir="ltr">
# <span class="bold">bdacli enable kerberos</span>
INFO: Logging all actions in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node01-20131104072502.log and traces in /opt/oracle/BDAMammoth/bdaconfig/tmp/bda1node01-20131104072502.trc
     .
     .
     .
INFO: Executing checkRoot.sh on nodes /opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
SUCCESS: Executed checkRoot.sh on nodes /opt/oracle/BDAMammoth/bdaconfig/tmp/all_nodes #Step -1#
SUCCESS: Password-less root SSH is setup.
 
 Do you want to setup KDC on a BDA node (yes/no): <span class="bold">yes</span>
 
 Please enter the realm name: <span class="bold">EXAMPLE.COM</span>
 
 Enter password for Kerberos database: <span class="italic"><span class="bold">password</span></span>
 Enter password again: <span class="italic"><span class="bold">password</span></span>
INFO: Executing changekrb5_kdc.sh on nodes bda1node01 #Step -1#
SUCCESS: Executed changekrb5_kdc.sh on nodes bda1node01 #Step -1#
SUCCESS: Successfully set the Kerberos configuration on the KDC
INFO: Setting up Master KDC
INFO: Executing setupKDC.sh on nodes bda1node01 #Step -1#
     .
     .
     .
</pre></li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<div class="sect3"><a id="GUID-1582D5ED-EFD3-438C-8049-8D7F777F4D13"></a>
<h3 id="BIGOG-GUID-1582D5ED-EFD3-438C-8049-8D7F777F4D13" class="sect3"><span class="enumeration_section">10.8.5</span> Installing Oracle Big Data Discovery</h3>
<div>
<p>Oracle Big Data Discovery is an end-to-end product for visual analysis of Big Data. You can install Oracle Big Data Discovery 1.5 or 1.4 (1.4.0.37.1388 or greater) on the Oracle Big Data Appliance if this product has been licensed.</p>
<p>For the 1.4 release, Oracle Software Delivery Cloud (<a href="https://edelivery.oracle.com/" target="_blank">https://edelivery.oracle.com</a>) may show Oracle Big Data Discovery 1.4.0.0.0 available for download. This is actually version 1.4.0.37.1388 or greater. Releases earlier than 1.4.0.37.1388 are not supported by this release of Oracle Big Data Appliance.</p>
<div class="infobox-note" id="GUID-1582D5ED-EFD3-438C-8049-8D7F777F4D13__GUID-F8BEF631-AAEA-469D-B320-63086A936478">
<p class="notep1">Note:</p>
<p>If Oracle Big Data Discovery 1.4.0.37.1388 or greater was already enabled prior to an upgrade to the current Oracle Big Data Appliance release, then after the upgrade you must update several client libraries required by Oracle Big Data Discovery. For instructions, see Document 2215083.1 in My Oracle Support (<a href="https://support.oracle.com/" target="_blank">https://support.oracle.com</a>). This manual update is not necessary if you install Oracle Big Data Discovery after installing the current Oracle Big Data Appliance release.</p>
<p>Earlier releases of Oracle Big Data Discovery are not supported on this Oracle Big Data Appliance release.</p>
</div>
<p>Use only the methods described in this document to install and uninstall Oracle Big Data Discovery on the Oracle Big Data Appliance. The installation procedure described in the <span class="italic">Oracle Big Data Discovery Installation Guide</span> should not be used in this context. The Oracle Big Data Appliance does not support the installation of WebLogic Server, Studio, and Dgraph on separate nodes of a CDH cluster.</p>
<p>If you are installing Big Data Discovery on an edge node, the Oracle Big Data Appliance installation process for Oracle Big Data Discovery does NOT apply. In the case of edge nodes, you should instead follow the normal installation process described in the <span class="italic">Oracle Big Data Discovery Installation Guide</span></p>
</div>
<div class="sect4"><a id="GUID-98ABF757-4BA5-4085-AFBE-AE1A03BC7820"></a>
<h4 id="BIGOG-GUID-98ABF757-4BA5-4085-AFBE-AE1A03BC7820" class="sect4"><span class="enumeration_section">10.8.5.1</span> How Oracle Big Data Discovery is Deployed on Oracle Big Data Appliance</h4>
<div>
<p>All Oracle Big Data Discovery (BDD) components are installed on a single node. Oracle Big Data Discovery will be installed on the fifth node of the cluster (referred to as &ldquo;Node 5&rdquo; in these instructions). After enabling BDD, the cluster will consist the remaining nodes. For example, nodes 1, 2, 3, 4, 6 in a starter rack.&nbsp; If necessary, you can later add Node 5 back into the CDH cluster by disabling Oracle Big Data Discovery. If you cannot afford to dedicate a node from the Hadoop cluster, you can install the software on a server external to Oracle Big Data Appliance and use the Oracle Big Data Appliance cluster for data processing. In that case, do not use the instructions in this section. Instead, see the Oracle Big Data Discovery product documentation in the <a href="http://docs.oracle.com/" target="_blank">Oracle Help Center</a> for other installation options.</p>
<div class="infobox-note" id="GUID-98ABF757-4BA5-4085-AFBE-AE1A03BC7820__GUID-538EDAE3-4FFD-431C-8D82-518192FCC222">
<p class="notep1">Restriction:</p>
This installation is not supported on Oracle Big Data Appliance systems running Oracle Linux 5.</div>
<p>To re-purpose Node 5 for use by Big Data Discovery, the installation removes all data currently on the server&rsquo;s drive array. It first checks that the required disk space exists elsewhere within the cluster. If this requirement is met, it then redistributes all Hadoop blocks on the server to the other nodes. No Hadoop data is lost. The installation then deprovisions the DataNode and NodeManager on the server and erases the data partitions (/u03 to /u12). Only the /boot, root (/)&nbsp; and the first two data partitions (/u01 and /u02)&nbsp; are left intact.</p>
<div class="infobox-note" id="GUID-98ABF757-4BA5-4085-AFBE-AE1A03BC7820__GUID-2307D30D-DEBF-4E97-83EE-C48F731D8A1A">
<p class="notep1">Important:</p>
It is the customer&rsquo;s responsibility to back up or move any non-Hadoop data that should be preserved prior to installing Oracle Big Data Discovery. The installation does not move any non-Hadoop data stored on Node 5. Non-Hadoop data present in data partitions /u03-/u12 on Node 5 are lost when the installation erases those data partitions.</div>
</div>
</div>
<div class="sect4"><a id="GUID-CF92E72B-7FB8-4EC5-95EB-65F2D8A0C767"></a>
<h4 id="BIGOG-GUID-CF92E72B-7FB8-4EC5-95EB-65F2D8A0C767" class="sect4"><span class="enumeration_section">10.8.5.2</span> Installing and Enabling Oracle Big Data Discovery</h4>
<div>
<p>This release of Oracle Big Data Appliance supports Oracle Big Data Discovery 1.5 as well as 1.4 (1.4.0.37.1388 or greater).</p>
<div class="section">
<p>You can download version 1.5 or 1.4 of Oracle Big Data Discovery from the <a href="https://edelivery.oracle.com" target="_blank">Oracle Software Delivery Cloud</a>. For version 1.4, the package available is actually 1.4.0.37.1388 or greater and is compatible with this release of Oracle Big Data Appliance.</p>
<p>To install Oracle Big Data Discovery on Oracle Big Data Appliance, use the instructions provided in the support document <a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=593455639606240&amp;id=2150755.1&amp;_adf.ctrl-state=qemvswj7h_77" target="_blank">2150755.1 &ndash; How to Enable/Disable Oracle Big Data Discovery 1.2.2 on Oracle Big Data Appliance V4.5/CDH5.7.1/OL6 with bdacli</a> in <a href="https://support.oracle.com" target="_blank">My Oracle Support</a>. Although these instructions are for installing on Oracle Big Data Appliance 4.5, they also work for the installation of either Oracle Big Data Discovery 1.5 or 1.4 on the current Oracle Big Data Appliance release. However, you need to adapt these steps as follows:</p>
<ul style="list-style-type: disc;">
<li>
<p>Ignore instructions to upgrade CDH. They are obsolete for this release of Oracle Big Data Appliance.</p>
</li>
<li>
<p>In the section <span class="italic">Prerequisites for Package Download</span>, select version 1.4 or 1.5.</p>
</li>
<li>
<p>Step 2 in the section <span class="italic">Enable BDD</span> describes how to copy and rename the download package filenames for version 1.2.2. Disregard this. The Oracle Software Delivery Cloud package download will show you a list of the files. Note down the filename and the description of each. After the download, rename the files as follows.</p>
<div class="tblformal" id="GUID-CF92E72B-7FB8-4EC5-95EB-65F2D8A0C767__GUID-484A6172-4F51-4E88-9652-C0CF11490728">
<table class="cellalignment224">
<thead>
<tr class="cellalignment165">
<th class="cellalignment267" id="d43346e1992">File Description</th>
<th class="cellalignment267" id="d43346e1994">Change Filename and Copy to...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment165">
<td class="cellalignment165" id="d43346e1998" headers="d43346e1992">
<p>First of two parts of the Oracle Big Data Discovery binary</p>
</td>
<td class="cellalignment165" headers="d43346e1998 d43346e1994"><code>/opt/oracle/bdd/bdd1.zip</code></td>
</tr>
<tr class="cellalignment165">
<td class="cellalignment165" id="d43346e2005" headers="d43346e1992">
<p>Second of two parts of the Oracle Big Data Discovery binary</p>
</td>
<td class="cellalignment165" headers="d43346e2005 d43346e1994"><code>/opt/oracle/bdd/bdd2.zip</code></td>
</tr>
<tr class="cellalignment165">
<td class="cellalignment165" id="d43346e2012" headers="d43346e1992">
<p>Installer for Oracle Big Data Discovery</p>
</td>
<td class="cellalignment165" headers="d43346e2012 d43346e1994"><code>/opt/oracle/bdd/installer.zip</code></td>
</tr>
<tr class="cellalignment165">
<td class="cellalignment165" id="d43346e2020" headers="d43346e1992">
<p>Oracle Fusion Middleware WebLogic Server and Coherence</p>
</td>
<td class="cellalignment165" headers="d43346e2020 d43346e1994"><code>/opt/oracle/bdd/</code> (no name change)</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" -->
<p>Extract the JAR file above from the WebLogic Server and Coherence zip file.</p>
</li>
</ul>
<p>Follow the rest of the instructions as documented in the My Oracle Support note.</p>
<div class="infobox-note" id="GUID-CF92E72B-7FB8-4EC5-95EB-65F2D8A0C767__GUID-7F5DDBB9-E030-4DE6-9437-FCF6DE062C75">
<p class="notep1">Important: Upgrading Oracle Big Data Discovery:</p>
Do not attempt to use the installation instructions provided here or in the My Oracle Support document (2150755.1) to upgrade an existing Oracle Big Data Discovery installation. Follow the upgrade instructions in the <a href="http://docs.oracle.com/cd/E78171_01/index.html" target="_blank">Oracle Big Data Discovery Upgrade Guide</a>.</div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect4"><a id="GUID-EA8CB7D0-B00C-4479-ADB0-8ABA18C7A356"></a>
<h4 id="BIGOG-GUID-EA8CB7D0-B00C-4479-ADB0-8ABA18C7A356" class="sect4"><span class="enumeration_section">10.8.5.3</span> Using Oracle Big Data Discovery</h4>
<div>
<p>Refer to the <a href="https://docs.oracle.com/cd/E71457_01/index.html" target="_blank">Oracle Big Data Discovery</a> documentation in the Oracle Help Center for instructions on using the software. Note that the site contains instructions for uninstalling, re-installing, upgrading, or otherwise reconfiguring Oracle Big Data Discovery that should not be used with the installation of the software on Oracle Big Data Appliance.&nbsp; Contact Oracle Support if you have questions about this.</p>
</div>
</div>
</div>
<div class="sect3"><a id="GUID-3A6A4251-4BFF-4853-852C-3447D31FD47A"></a>
<h3 id="BIGOG-GUID-3A6A4251-4BFF-4853-852C-3447D31FD47A" class="sect3"><span class="enumeration_section">10.8.6</span> Installing Oracle Big Data SQL</h3>
<div>
<p>Oracle Big Data SQL supports queries against non-relational data stored in multiple big data sources, including Apache Hive, HDFS, Oracle NoSQL Database, Apache HBase, and other NoSQL databases. It enables unified query for distributed data and therefore the ability to view and analyze data from disparate data stores seamlessly, as if it were all stored in an Oracle database.</p>
<p>Oracle Big Data SQL is included in the Oracle Big Data Appliance installation bundle. You do not need to download it separately.</p>
<div class="infoboxnotealso" id="GUID-3A6A4251-4BFF-4853-852C-3447D31FD47A__GUID-A0632336-8028-4DA7-A9E1-0DD88DD24AF9">
<p class="notep1">See Also:</p>
This section is an overview of the Oracle Big Data SQL installation for Oracle Big Data Appliance customers. For complete information on installing, configuring, and using Oracle Big Data SQL, refer to these documents:
<ul style="list-style-type: disc;">
<li>
<p><a class="olink BDSIG-GUID-29BAFB68-E852-4AD3-931B-30DF65BBCD44" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSIG-GUID-29BAFB68-E852-4AD3-931B-30DF65BBCD44">Oracle Big Data SQL Installation Guide</a></p>
</li>
<li>
<p><a class="olink BDSUG-GUID-332EB44C-1E95-439A-A294-ECF0E8B863D2" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSUG-GUID-332EB44C-1E95-439A-A294-ECF0E8B863D2">Oracle Big Data SQL User&rsquo;s Guide</a></p>
</li>
</ul>
</div>
<div class="infobox-note" id="GUID-3A6A4251-4BFF-4853-852C-3447D31FD47A__GUID-877411AC-543B-4033-B5BC-DA9B19EF7218">
<p class="notep1">Note:</p>
A license is required to install Oracle Big Data SQL on Oracle Big Data Appliance. No additional license is required for the Oracle Database side of the installation.
<p>See the <a class="olink BIGLI-GUID-8E911C46-3FAA-44BA-BCEE-FB9EF94E494E" target="_blank" href="../BIGLI/bda.htm#BIGLI-GUID-8E911C46-3FAA-44BA-BCEE-FB9EF94E494E">Oracle Big Data Appliance Licensing Information User Manual</a> for details on licensing requirements.</p>
</div>
<div class="section">
<p class="subhead3">Supported Connections to Oracle Database</p>
<div class="p">When installed on Oracle Big Data Appliance, Oracle Big Data SQL can be configured to connect the following Oracle Database systems:
<ul style="list-style-type: disc;">
<li>
<p>Oracle Exadata Database Machine</p>
</li>
<li>
<p>Oracle Database on Oracle Linux or RHEL-based commodity servers. Specific systems are listed in the <a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=400361405103392&amp;id=2119369.1&amp;_adf.ctrl-state=j8ryazrl8_77" target="_blank">Oracle Big Data SQL Master Compatibility Matrix</a> (Doc ID 2119369.1 in <a href="https://support.oracle.com/" target="_blank">My Oracle Support</a>)</p>
</li>
</ul>
</div>
<p>Oracle Big Data SQL can connect to both single-node Oracle Databases and multinode databases (such as Oracle RAC).</p>
<p>See the compatibility matrix for details on support for the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Oracle Engineered Systems.</p>
</li>
<li>
<p>Other systems.</p>
</li>
<li>
<p>Linux OS distributions and versions.</p>
</li>
<li>
<p>Hadoop distributions.</p>
</li>
<li>
<p>Oracle Database releases, including required patches.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Networking Requirements</p>
<p>Oracle Big Data Appliance and the Oracle Database system must be networked together via Ethernet or InfiniBand. (Connectivity to Oracle SuperCluster is InfiniBand only). For Ethernet connections between Oracle Database and Oracle Big Data Appliance, Oracle recommends 10 Gb/s Ethernet.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Phases of the Installation</p>
<p>The installation consists of two phases in every case and may include a third:</p>
<ol>
<li>
<p>Installing on Oracle Big Data Appliance.</p>
<p>The Oracle Big Data Appliance Configuration Generation Utility provides form fields to direct Mammoth to include Oracle Big Data SQL in your installation.</p>
<p>You can also use the bdacli utility enable Oracle Big Data SQL at any time after the Mammoth installation:</p>
</li>
<li>
<p>Installing on the Oracle Database system.</p>
<p>You must do this part of the installation manually. A database-side installation bundle is generated when you run the Oracle Big Data Appliance installation. You must copy this bundle over to each compute node of the Oracle Database system, unpack it, and install it.</p>
</li>
<li>
<p>Enabling optional security and user access features (not part of the default installation)</p>
<p>You can customize the Oracle Big Data SQL installation to include features that are not configurable in the default installation on Oracle Big Data Appliance, such as <span class="italic">Multi-User Authorization</span>, which enables users other than the database owner to run Oracle Big Data SQL queries against data in the Hadoop clusters on the appliance. Completing the activation of this feature (as well as <span class="italic">Database Authentication</span>, which is enabled by default) requires a third step in the installation process.</p>
</li>
</ol>
<div class="infoboxnotealso" id="GUID-3A6A4251-4BFF-4853-852C-3447D31FD47A__GUID-107B0443-7CE7-421B-BB09-D784F2F794CE">
<p class="notep1">See Also:</p>
Instructions on how to install the database-side bundle and enable optional features are provided in the <a class="olink BDSIG-GUID-FF8C8A1B-E752-4998-AAB6-C0EF68C7C312" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSIG-GUID-FF8C8A1B-E752-4998-AAB6-C0EF68C7C312">Oracle Big Data SQL Installation Guide</a>.</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Installing Over an Existing Oracle Big Data SQL Installation</p>
</div>
<!-- class="section" -->
<p>It is not necessary to uninstall a previous version of the software. The installation will upgrade the previously installed version to the current release level.</p>
<div class="infobox-note" id="GUID-3A6A4251-4BFF-4853-852C-3447D31FD47A__GUID-E76EC8EE-960C-4E8C-80AB-77AFB2315855">
<p class="notep1">Note:</p>
If a previous of Oracle Big Data SQL already exists on the Oracle Big Data Appliance, the Mammoth installer will upgrade this installation to the current release level regardless of whether or not you select Oracle Big Data SQL for installation via the form fields in the Configuration Generation Utility.</div>
<p>On Oracle Big Data Appliance, the software is installed at <code class="codeph">/opt/oracle/BDSJaguar</code> on the configuration management server (the node where Cloudera Configuration Manager is running).</p>
<div class="section">
<p class="subhead3">Automatic Setup of Ticket Renewal for Kerberos-Secured Environments</p>
<p>If your environment is Kerberos-secured, the installation automatically sets up a cron job to renew the ticket for the <code class="codeph">oracle</code> account principal four times per day. This frequency is to satisfy the AD Kerberos requirement. The extra kinits are harmless for MIT Kerberos. The automation is set up as needed for both Oracle Big Data Appliance and the Oracle Database system.</p>
</div>
<!-- class="section" --></div>
<div class="sect4"><a id="GUID-DD816D88-33B6-49B8-979E-A92752E11AD6"></a>
<h4 id="BIGOG-GUID-DD816D88-33B6-49B8-979E-A92752E11AD6" class="sect4"><span class="enumeration_section">10.8.6.1</span> Installing on Oracle Big Data Appliance</h4>
<div>
<p>Oracle Big Data SQL can be installed via the Mammoth or bdacli utilities. Earlier releases are automatically upgraded on the Oracle Big Data Appliance side.</p>
<div class="infobox-note" id="GUID-DD816D88-33B6-49B8-979E-A92752E11AD6__GUID-C577E9B4-BFC7-42A3-80C0-4FD9836364EA">
<p class="notep1">Note:</p>
Oracle Big Data Appliance 4.11 does not require Patch 27077322 in order to install Oracle Big Data SQL 3.2. This patch was required on Oracle Big Data Appliance 4.10 only.</div>
<div class="section">
<p class="subhead3">If This is a First-Time Installation (no Earlier Release Installed)</p>
<p><span class="bold">Directing Mammoth to install the software:</span></p>
<p>You can include Oracle Big Data SQL in the Mammoth installation by selecting it in the Oracle Big Data Appliance Configuration Generation Utility. You must make the selection for each cluster where you want to install the software.</p>
<p>Set up the Oracle Big Data SQL installation on Cluster Definition page of the Configuration Generation Utility as shown in the figure below.</p>
<div class="figure" id="GUID-DD816D88-33B6-49B8-979E-A92752E11AD6__GUID-51A6BF62-C20D-408F-AF16-01274D1AB005">
<p class="titleinfigure">Figure 10-1 Oracle Big Data SQL Fields in the Configuration Generation Utility</p>
<img width="627" height="112" src="img/GUID-013304FC-0ED8-4E83-825E-D9E3987F833E-default.png" alt="The figure shows the three Oracle Big Data SQL form fields in the Configuration Generation Utlity" title="The figure shows the three Oracle Big Data SQL form fields in the Configuration Generation Utlity" /></div>
<!-- class="figure" -->
<ol>
<li>
<p>If you select <span class="bold">Yes</span> to the licensing question, you can proceed to the other options. Also select <span class="bold">Yes</span> in response to &ldquo;<code class="codeph">Install Big Data SQL?&rdquo;</code></p>
</li>
<li>
<p>Specify whether Oracle Big Data Appliance is connected to the Oracle Database system over an Ethernet or InfiniBand connection. Both are supported.</p>
</li>
</ol>
<p>When you generate the configuration files, the directive to run the Oracle Big Data SQL installation is added to the <code class="codeph">&lt;<span class="codeinlineitalic">cluster name</span>&gt;-config.json</code> file.</p>
<p><span class="bold">Performing a post-Mammoth installation, using bdacli:</span></p>
<div class="p">If you did not include Oracle Big Data SQL in the Mammoth installation, you can use the bdacli utility to enable it at any time after the Mammoth installation:
<pre dir="ltr">
# bdacli enable big_data_sql
</pre></div>
<p>Both Mammoth and bdacli install Oracle Big Data SQL on all of the DataNodes of the selected cluster.</p>
<div class="infobox-note" id="GUID-DD816D88-33B6-49B8-979E-A92752E11AD6__GUID-10EB14C3-3E0D-4FFB-B940-334A2937CA69">
<p class="notep1">Note:</p>
In order to make use of the Database Authentication feature described in the Oracle Big Data SQL Installation Guide, you must generate and install a GUID-key pair. This process starts by running the following command on the node where Cloudera Configuration Manager is installed in order to generate the key:.
<div class="p">
<pre dir="ltr">
# ./jaguar --requestdb &lt;<span class="italic">database name</span>&gt; databasereq
</pre></div>
<p>You then copy the file that contains that key to the Oracle Database server prior to running the database-side installation of Oracle Big Data SQL. There are several other steps to complete the process of enabling Database Authentication. Read through <a class="olink BDSIG-GUID-CB4E25D4-B406-4CED-9097-D897C1AEAA58" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSIG-GUID-CB4E25D4-B406-4CED-9097-D897C1AEAA58">Installing or Upgrading the Hadoop Side of Oracle Big Data SQL</a> in the Oracle Big Data SQL Installation Guide to learn about the Jaguar utility used to generate the key file and about the complete key generation and installation process.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">If an Earlier Release of Oracle Big Data SQL is Already Installed</p>
</div>
<!-- class="section" -->
<p>In this case, you do not need to select Oracle Big Data SQL in the Configuration Generation Utility. Mammoth will automatically upgrade the earlier Oracle Big Data SQL release to the current version on all clusters where it is currently installed.</p>
<div class="infobox-note" id="GUID-DD816D88-33B6-49B8-979E-A92752E11AD6__GUID-7BB20ABB-8394-49CF-AEBB-D7F94EC05E8A">
<p class="notep1">Note:</p>
Upgrade of the Oracle Database side of the installation is not automatic. Install the database side of the software as described in this guide.</div>
</div>
</div>
<div class="sect4"><a id="GUID-B28E8660-E46A-4C0D-88D3-A5FD5EDDB76E"></a>
<h4 id="BIGOG-GUID-B28E8660-E46A-4C0D-88D3-A5FD5EDDB76E" class="sect4"><span class="enumeration_section">10.8.6.2</span> Customizing the Default Oracle Big Data SQL Installation</h4>
<div>
<p>If you install Oracle Big Data SQL with Mammoth or bdacli and (with no customization) install the basic database-side installation bundle that both of these utilities generate, then you have access to all of the functionality described in the <a class="olink BDSUG-GUID-60F61D46-EAF7-463E-A62C-C1E08EA58726" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSUG-GUID-60F61D46-EAF7-463E-A62C-C1E08EA58726">Oracle Big Data SQL User&rsquo;s Guide</a>. However, you can reconfigure this initial installation to make the following changes:</p>
<ul style="list-style-type: disc;">
<li>
<p>Add Multi-User Authorization.</p>
<p>In previous releases of Oracle Big Data SQL, all queries against Hadoop and Hive data are executed as the <code class="codeph">oracle</code> user and there is no option to change users. Although <code class="codeph">oracle</code> is still the underlying user in all cases, Oracle Big Data SQL can now use Hadoop Secure Impersonation to direct the oracle account to execute tasks on behalf of other designated users. This enables HDFS data access based on the user that is currently executing the query, rather than the singular <code class="codeph">oracle</code> user.</p>
</li>
<li>
<p>Switch the network used by Oracle Big Data SQL.</p>
</li>
<li>
<p>If the physical connections to support it are in place, you can switch Oracle Big Data Appliance and Oracle Database server from Ethernet to InfiniBand or vice versa without the need to reinstall Oracle Big Data SQL.</p>
</li>
</ul>
<p>You can reconfigure the installation again later to reverse any of these changes.</p>
<p>Note that Database Authentication is enabled in the configuration by default, <span class="italic">however, you still need to go through the process of generating and installation the guid-key pair that is the basis for authentication if you want to use that feature</span>.</p>
<div class="section">
<p class="subhead3">Using the Jaguar Utility to Reconfigure the Installation</p>
<p>Use the Jaguar utility in Oracle Big Data SQL to reconfigure the default installation. Jaguar reads a JSON file in which you set the configurable parameters of the installation. The default configuration file is <code class="codeph">bds-config.json</code>, but you can use any name. The recommended method for starting a custom configuration is to make a copy of the default <code class="codeph">bds-config.json</code> created by Mammoth and add your customizations to this file.</p>
<p>When you run <code class="codeph">jaguar reconfigure</code>, the operation reads the parameters you have set in the configuration file, modifies the Oracle Big Data Appliance side of the installation accordingly, and also generates a new database-side installation bundle that supports the feature changes you have made.</p>
<div class="infobox-note" id="GUID-B28E8660-E46A-4C0D-88D3-A5FD5EDDB76E__GUID-CDFF0A1E-F9FC-45B2-8C02-C11C55FB15B8">
<p class="notep1">Note:</p>
<p>Jaguar provides a number of different operations, including install and uninstall. However if you have installed the version of Oracle Big Data SQL that is bundled with Oracle Big Data Appliance, do not run the Jaguar install and uninstall operations. Use the Configuration Generation Utility or bdacli to enable or disable the software.</p>
</div>
<div class="infoboxnotealso" id="GUID-B28E8660-E46A-4C0D-88D3-A5FD5EDDB76E__GUID-654B9046-E106-49D5-8F1B-43DA85475D6C">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><a class="olink BDSIG-GUID-12D293B8-EE83-4FBC-9289-EBC6E9398D23" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSIG-GUID-12D293B8-EE83-4FBC-9289-EBC6E9398D23">About the Jaguar Utility</a> in the <span class="italic">Oracle Big Data SQL Installation Guide</span></p>
</li>
<li>
<p><a class="olink BDSIG-GUID-91773A49-ABB4-4BC8-9068-3238DF50A108" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSIG-GUID-91773A49-ABB4-4BC8-9068-3238DF50A108">Jaguar Configuration Parameter and Command Reference</a>, also in the <span class="italic">Oracle Big Data SQL Installation Guide</span></p>
</li>
</ul>
</div>
<div class="infobox-note" id="GUID-B28E8660-E46A-4C0D-88D3-A5FD5EDDB76E__GUID-2E297925-29F2-4448-B533-60696418672C">
<p class="notep1">Important:</p>
If you create and use a custom configuration file, be sure to make a backup of the file and store it in a safe location. The file is the record of your configuration and you may need it to recreate the configuration. This is not only to protect it from accidental deletion or modification by a user. Certain Mammoth and bdacli processes remove or overwrite the Oracle Big Data SQL installation directory <code class="codeph">/opt/oracle/BDSJaguar</code> on the configuration management server (the node where Configuration Manager runs).
<ul style="list-style-type: disc;">
<li>
<p>A Mammoth extension (<code class="codeph"># mammoth -e</code>) or Mammoth upgrade (<code class="codeph"># mammoth -p</code>) deletes the Oracle Big Data SQL installation directory.</p>
</li>
<li>
<p>A reprovisioning (<code class="codeph"># bdacli admin-cluster reprovision &lt;<span class="codeinlineitalic">node name</span>&gt;</code>) prompts you to delete the directory.</p>
</li>
<li>
<p>A re-run of <code class="codeph"># bdacli install</code> will overview your custom configuration with the default configuration.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect4"><a id="GUID-0B5888E3-481E-4E14-B4AC-2424A50D34BF"></a>
<h4 id="BIGOG-GUID-0B5888E3-481E-4E14-B4AC-2424A50D34BF" class="sect4"><span class="enumeration_section">10.8.6.3</span> Installing Oracle Big Data SQL on the Oracle Database System</h4>
<div>
<p>When you install Oracle Big Data SQL on Oracle Big Data Appliance, this process also generates a database-side installation bundle. Install this bundle on the database system where you intend to run Oracle Big Data SQL queries against the Hadoop data on Oracle Big Data Appliance.</p>
<ol>
<li>
<p>After the installation on Oracle Big Data Appliance is complete, log on as <code class="codeph">root</code> to the configuration management server (the Oracle Big Data Appliance node where Cloudera Configuration Manager is running).</p>
</li>
<li>
<p>Navigate to <code class="codeph">/opt/oracle/BDSJaguar/db-bundles</code>.</p>
<p>The installation bundle in this directory is a ZIP file that includes the cluster name and a creation timestamp, such as:</p>
<pre dir="ltr">
bds-3.2.0-db-&lt;cluster name&gt;-&lt;yymmdd.hhmi&gt;.zip
</pre></li>
<li>
<p>To install this bundle on the Oracle Database system follow the instructions in <a class="olink BDSIG-GUID-E0E62C0F-F4FA-436A-95E8-0EB3287802A4" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E92664-01&amp;id=BDSIG-GUID-E0E62C0F-F4FA-436A-95E8-0EB3287802A4">Installing or Upgrading the Oracle Database Side of Oracle Big Data SQL</a> in the <span class="italic">Oracle Big Data SQL Installation Guide</span>.</p>
<div class="infobox-tip" id="GUID-0B5888E3-481E-4E14-B4AC-2424A50D34BF__GUID-FEC81D53-B821-4484-B352-2A8A279A888A">
<p class="notep1">Tip:</p>
As discussed in the previous section, you have the option of using the Jaguar <code class="codeph">reconfigure</code> operation to customize the installation before you install the database-side bundle.</div>
</li>
</ol>
</div>
</div>
<div class="sect4"><a id="GUID-6F2BD78E-3AA2-420D-94ED-52677CE24992"></a>
<h4 id="BIGOG-GUID-6F2BD78E-3AA2-420D-94ED-52677CE24992" class="sect4"><span class="enumeration_section">10.8.6.4</span> Managing the Oracle Big Data SQL Service</h4>
<div>
<p>When Oracle Big Data SQL is installed on the appliance, its <code class="codeph">bd_cell</code> service is installed and started on all DataNodes of the Hadoop cluster.</p>
<p>The Oracle Big Data Appliance bdacli utility provides operations to manage the Oracle Big Data SQL service on each DataNode and also cluster-wide.</p>
<p><span class="bold">For the instance of the service on a single DataNode:</span></p>
<pre dir="ltr">
bdacli {start | stop | restart | status} big_data_sql_server &lt;<span class="italic">node name</span>&gt;
</pre>
<p><span class="bold">For all instances within the cluster:</span></p>
<pre dir="ltr">
bdacli {start | stop | restart | status} big_data_sql_cluster
</pre>
<div class="infobox-note" id="GUID-6F2BD78E-3AA2-420D-94ED-52677CE24992__GUID-2F269BB4-C872-4DCD-9DDD-CADF80B070F0">
<p class="notep1">Note:</p>
<p>The bdacli utility also provides <code class="codeph"># bdacli {enable | disable} big_data_sql</code> to install or uninstall the service cluster-wide. If you have customized the installation by adding non-default configuration parameters, be aware that these commands will overwrite your custom configuration with the default configuration. If you use them, first be sure that you have archived a copy of your custom configuration file so that you can use the Jaguar reconfigure operation to restore your customizations.</p>
</div>
<div class="infoboxnotealso" id="GUID-6F2BD78E-3AA2-420D-94ED-52677CE24992__GUID-D75A0984-E961-40B8-8022-790C20FD5A7C">
<p class="notep1">See Also:</p>
The <a href="utilities.htm#GUID-685D1923-EC2A-42B6-8D97-1DFB8239D57C">bdacli reference</a> in this guide describes bdacli operations available for managing Oracle Big Data SQL and other services.</div>
</div>
</div>
<div class="sect4"><a id="GUID-D91D277D-2C36-406F-9401-D864055F364E"></a>
<h4 id="BIGOG-GUID-D91D277D-2C36-406F-9401-D864055F364E" class="sect4"><span class="enumeration_section">10.8.6.5</span> Uninstalling Oracle Big Data SQL</h4>
<div>
<p>To completely uninstall Oracle Big Data SQL, remove the software from both Oracle Big Data Appliance and from the Oracle Database system.</p>
<div class="section">
<p class="subhead3">Uninstalling from the Oracle Database System</p>
<p>Use the <code>bds-database-install.sh</code> script utility to install/uninstall the database side of Oracle Big Data SQL.</p>
<div class="p">On the Oracle Database server (or on each node of a multinode database) run <code class="codeph">bds-database-install.sh</code> with the <code class="codeph">--uninstall</code> parameter.
<pre dir="ltr">
$ /bds-database-install.sh --uninstall --crs=false  
</pre></div>
<div class="infobox-note" id="GUID-D91D277D-2C36-406F-9401-D864055F364E__GUID-6EDF69A3-3219-4909-A34D-A69B98CF954D">
<p class="notep1">Note:</p>
<p>If Grid is not running on this database node, or, if the database does not use Grid (CRS/ASM), then include the optional <code class="codeph">--crs</code> parameter and set it to <code class="codeph">false</code>.</p>
Also note that the <code class="codeph">--uninstall-as-primary</code> and <code class="codeph">--uninstall-as-secondary</code> parameters from previous releases are deprecated in this release. It is no longer necessary to differentiate between primary and secondary clusters in the uninstall process.</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Uninstalling from Oracle Big Data Appliance</p>
<p>Use bdacli to disable (uninstall) Oracle Big Data SQL on Oracle Big Data Appliance.</p>
<pre dir="ltr">
# bdacli disable big_data_sql
</pre>
This command uninstalls the software from all DataNodes in the entire cluster.</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<a id="BIGOG76640"></a>
<div class="props_rev_3"><a id="GUID-D9F92052-5A1B-44BA-8B95-5B4C10D57DA1"></a>
<h2 id="BIGOG-GUID-D9F92052-5A1B-44BA-8B95-5B4C10D57DA1" class="sect2"><span class="enumeration_section">10.9</span> Reinstalling the Base Image</h2>
<div>
<p>The operating system and various utilities are factory installed on Oracle Big Data Appliance, as described in <span class="q">"<a href="intro.htm#GUID-ABEAC9ED-A052-4C8D-AB3B-BE69445F3CED">Oracle Big Data Appliance Management Software</a>"</span>. You may need to reinstall this base image if, for example, you want to return Oracle Big Data Appliance to its original state, or you replaced a failed server. Mammoth automatically upgrades the base image as necessary before upgrading the Oracle Big Data Appliance software to a newer version.</p>
<p>You can reimage all or part of a rack. However, all the servers in a cluster must have the same image. Follow the appropriate instructions:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="mammoth.htm#GUID-8AE24D0E-465C-4ADC-BF1A-AEE722073083">Reimaging a Single Oracle Big Data Appliance Server</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-1ED03FDD-CFAE-4A97-A54F-FFA3BB08E7B6">Reimaging an Oracle Big Data Appliance Rack</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-BADEA83A-4E51-4ADD-ABD6-800DFEF3BBE3">Reimaging an Oracle Big Data Appliance Cluster</a></p>
</li>
</ul>
<div class="infobox-note" id="GUID-D9F92052-5A1B-44BA-8B95-5B4C10D57DA1__GUID-CF20D24B-46D6-4EFA-80AE-6C11605CD460">
<p class="notep1">Note:</p>
If the base image version is less than 4.5.0-6, then before reimaging, it is recommended that you apply patch <a href="https://support.oracle.com/epmos/faces/PatchResultsNDetails?_adf.ctrl-state=5b8vffx0o_14&amp;releaseId=600000000063988&amp;requestId=21366129&amp;patchId=23241894&amp;languageId=0&amp;platformId=226&amp;searchdata=%3Ccontext+type=%22BASIC%22+search=%22&amp;lt;Search&amp;gt;%20&amp;lt;Filter+name=&amp;quot;patch_number&amp;quot;+op=&amp;quot;is&amp;quot;+value=&amp;quot;23241894&amp;quot;/&amp;gt;%20&amp;lt;Filter+name=&amp;quot;exclude_superseded&amp;quot;+op=&amp;quot;is&amp;quot;+value=&amp;quot;false&amp;quot;/&amp;gt;%20&amp;lt;/Search&amp;gt;%22/%3E&amp;_afrLoop=584487113724976" target="_blank">23241894</a> in order to update the base image to BDA v4.5.0-6. See Document 2135358.1 in <a href="https://support.oracle.com" target="_blank">My Oracle Support</a> for a description of the patch.</div>
</div>
<a id="BIGOG76857"></a>
<div class="props_rev_3"><a id="GUID-8AE24D0E-465C-4ADC-BF1A-AEE722073083"></a>
<h3 id="BIGOG-GUID-8AE24D0E-465C-4ADC-BF1A-AEE722073083" class="sect3"><span class="enumeration_section">10.9.1</span> Reimaging a Single Oracle Big Data Appliance Server</h3>
<div>
<div class="section">
<p>Follow this procedure to reimage one server, for example, following replacement of a failed server.</p>
<div class="infobox-note" id="GUID-8AE24D0E-465C-4ADC-BF1A-AEE722073083__GUID-F9B6FC19-530A-4505-97C8-385B7C3DA730">
<p class="notep1">Caution:</p>
<p>If you reimage a server, then all files and data are erased.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To reinstall the base image on one server:</p>
<ol>
<li>
<p>Download the base image patch from My Oracle Support or Oracle Automated Release Updates (ARU), and copy it to the server being reimaged.</p>
<div class="infobox-note" id="GUID-8AE24D0E-465C-4ADC-BF1A-AEE722073083__GUID-9FF88C3B-203C-46AB-BABE-7618F131E648">
<p class="notep1">Caution:</p>
<p>Use the most recent 4.<span class="italic">x</span> version of the base image. Do not use the version included in the Mammoth bundle.</p>
</div>
<p>See <span class="q">"<a href="mammoth.htm#GUID-29022554-078A-4E5F-9868-4AD9AF3858AA">Downloading the Mammoth Software Deployment Bundle</a>."</span> You can take the same basic steps to download the base image patch from My Oracle Support.</p>
</li>
<li>
<p>If you are reimaging the server to the current customer settings, verify that <code>/opt/oracle/bda/rack-network.json</code> and <code>/opt/oracle/bda/cluster-network.json</code> reflect the intended network configuration. If it does not, then generate a new set of files using Oracle Big Data Appliance Configuration Generation Utility. See <span class="q">"<a href="configurator.htm#GUID-92C6E1FE-6107-4170-BC08-66C4CF9FEE41">Generating the Configuration Files</a>."</span></p>
(Note that use of <code class="codeph">/opt/oracle/bda/network.json</code> is still supported, but not recommended.)</li>
<li>
<p>Ensure that 4 GB or more disk space are free in the partition:</p>
<pre dir="ltr">
$ <span class="bold">df -h</span>
Filesystem            Size  Used Avail Use% Mounted on
/dev/md2              161G   23G  130G  15% /
/dev/md0              194M   40M  145M  22% /boot
tmpfs                  24G     0   24G   0% /dev/shm
/dev/sda4             1.7T  197M  1.7T   1% /u01
/dev/sdb4             1.7T  197M  1.7T   1% /u02
/dev/sdc1             1.8T  199M  1.8T   1% /u03
/dev/sdd1             1.8T  199M  1.8T   1% /u04
     .
     .
     .
</pre></li>
<li>
<p>Unzip the downloaded base image ZIP file. The following example shows a partial listing of the output to the command line:</p>
<pre dir="ltr">
<span class="bold"># unzip p&lt;<span class="italic">number</span>&gt;_&lt;<span class="italic">version</span>&gt;_Linux-x86-64.zip</span>
Archive: p&lt;<span class="italic">number</span>&gt;_Linux-x86-64.zip
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/
extracting: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/orabalancer-&lt;<span class="italic">version</span>&gt;-h2.zip
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/orabalancer-&lt;<span class="italic">version</span>&gt;-h2.noarch.rpm
extracting: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/orabalancerdemo-&lt;<span class="italic">version</span>&gt;-h2.zip
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/CELL/
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/CELL/bd_cell-&lt;<span class="italic">version</span>&gt;_LINUX.X64_160506.11
...
</pre></li>
<li>
<p>Change to the subdirectory created in the previous step:</p>
<pre dir="ltr">
# cd BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE
 
</pre></li>
<li>
<p>Log on to the server to be reimaged and run the <code class="codeph">makebdaimage</code> command. The the example below show the command to reimage Node 4 (including the internal USB) from the base image to the custom settings in the configuration files. Comma-separate<code class="codeph">rack-network.json</code> and <code class="codeph">cluster-network.json</code> and submit them as a single parameter.</p>
<pre dir="ltr">
# ./makebdaimage -usbint BDABaseImage-&lt;version&gt;_RELEASE.iso /opt/oracle/bda/rack-network.json,/opt/oracle/bda/cluster-network.json 4
</pre>
<p>Note that submitting <code class="codeph">network.json</code> as the file parameter still works, but is no longer recommended:</p>
<pre dir="ltr">
# ./makebdaimage -usbint BDABaseImage-&lt;<span class="italic">version</span>&gt;_RELEASE.iso /opt/oracle/bda/network.json 4
</pre></li>
<li>
<p>If the <code class="codeph">makebdaimage</code> command succeeds without errors, then restart the server.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76858"></a>
<div class="props_rev_3"><a id="GUID-1ED03FDD-CFAE-4A97-A54F-FFA3BB08E7B6"></a>
<h3 id="BIGOG-GUID-1ED03FDD-CFAE-4A97-A54F-FFA3BB08E7B6" class="sect3"><span class="enumeration_section">10.9.2</span> Reimaging an Oracle Big Data Appliance Rack</h3>
<div>
<div class="section">
<p><a id="d43346e2838" class="indexterm-anchor"></a><a id="d43346e2840" class="indexterm-anchor"></a>Follow this procedure to reimage an entire rack.</p>
<div class="infobox-note" id="GUID-1ED03FDD-CFAE-4A97-A54F-FFA3BB08E7B6__GUID-B1ED82A3-46BF-4366-878F-9FB2E87E45ED">
<p class="notep1">Caution:</p>
<p>If you reimage an entire rack, then all clusters, files, and data on the rack are erased. Reimaging is <span class="italic">not</span> required for a software upgrade.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To reinstall the base image on all servers in a rack:</p>
<ol>
<li>
<p>If the Oracle Big Data Appliance software was installed previously on the rack, then save the <code class="codeph">/opt/oracle/BDAMammoth/</code><span class="italic"><code class="codeph">cluster_name</code></span><code class="codeph">-config.json</code> file to a safe place outside Oracle Big Data Appliance.</p>
</li>
<li>
<p>Download the most recent base image patch from My Oracle Support or Oracle Automated Release Updates (ARU), and copy it to the first (bottom) server of the rack being reimaged.</p>
<p>See <span class="q">"<a href="mammoth.htm#GUID-29022554-078A-4E5F-9868-4AD9AF3858AA">Downloading the Mammoth Software Deployment Bundle</a>."</span> You can take the same basic steps to download the base image patch from My Oracle Support.</p>
<div class="infobox-note" id="GUID-1ED03FDD-CFAE-4A97-A54F-FFA3BB08E7B6__GUID-7F756733-1200-472A-B423-41411205BA3A">
<p class="notep1">Caution:</p>
<p>Use the most recent 4.<span class="italic">x</span> version of the base image. Do not use the version included in the Mammoth bundle.</p>
</div>
</li>
<li>
<p>Establish an SSH connection to the first server and log in as <code class="codeph">root</code>.</p>
</li>
<li>
<p>If you are reimaging to existing customer network settings, then verify that <code class="codeph">/opt/oracle/bda/network.json</code> reflects the intended network configuration. If it does not, then generate a new file using Oracle Big Data Appliance Configuration Generation Utility.</p>
</li>
<li>
<p>Ensure that passwordless SSH is set up:</p>
<pre dir="ltr">
# <span class="bold">dcli hostname</span>
192.168.41.37: bda1node01.example.com
192.168.41.38: bda1node02.example.com
192.168.41.39: bda1node03.example.com
     .
     .
     .
</pre>
<p>This command must run without errors and return the host names of all Oracle Big Data Appliance servers. If not, then follow the steps in <span class="q">"<a href="dcli.htm#GUID-3E1D048B-3EDF-4E14-81E8-93741428708B">Setting Up Passwordless SSH</a>"</span>. Do not continue until the <code class="codeph">dcli hostname</code> command runs successfully on all servers.</p>
</li>
<li>
<p>Check all Oracle Big Data Appliance servers for hardware issues:</p>
<pre dir="ltr">
# dcli bdacheckhw | grep -v SUCCESS
</pre></li>
<li>
<p>Resolve any hardware errors and warnings before reimaging the rack.</p>
</li>
<li>
<p>Verify that at least 4 GB are available in the root (/) partition of all servers:</p>
</li>
<li>
<pre dir="ltr">
# <span class="bold">dcli df -h /</span>
192.168.41.37: Filesystem            Size  Used Avail Use% Mounted on
192.168.41.37: /dev/md2              161G   21G  132G  14% /
192.168.41.38: Filesystem            Size  Used Avail Use% Mounted on
192.168.41.38: /dev/md2              161G   19G  135G  12% /
192.168.41.39: Filesystem            Size  Used Avail Use% Mounted on
192.168.41.39: /dev/md2              161G   23G  131G  15% /
     .
     .
     .
</pre></li>
<li>
<p>Unzip the downloaded base image ZIP file. For example:</p>
<pre dir="ltr">
<span class="bold"># unzip p&lt;<span class="italic">number</span>&gt;_&lt;<span class="italic">version</span>&gt;_Linux-x86-64.zip</span>
Archive:  p&lt;<span class="italic">number</span>&gt;_&lt;<span class="italic">version</span>&gt;_Linux-x86-64.zip    
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/   
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/biosconfig     
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/makebdaimage    
extracting: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE.md5sum     
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/reimagerack     
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/reimagecluster     
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE.iso      
.
.
.
</pre></li>
<li>
<p>Change to the subdirectory created in the previous step:</p>
<pre dir="ltr">
# cd BDABaseImage-ol6-&lt;version&gt;_RELEASE 
</pre></li>
<li>
<p>Complete one of the following procedures:</p>
<ul style="list-style-type: disc;">
<li>
<p>To reimage an Oracle Big Data Appliance that was configured for a customer network to the same customer network settings, execute the <code class="codeph">./reimagerack</code> command.</p>
</li>
<li>
<p>To reimage an appliance that still has the factory settings:</p>
<ol>
<li>
<p>Ensure that <code class="codeph">/opt/oracle/bda/network.json</code> does not exist.</p>
</li>
<li>
<p>Execute the <code class="codeph">./reimagerack</code> command.</p>
</li>
</ol>
</li>
<li>
<p>To restore the factory network settings on a rack configured with custom network settings:</p>
<ol>
<li>
<p>Copy <code class="codeph">/opt/oracle/bda/network.json</code> to a safe location outside Oracle Big Data Appliance.</p>
</li>
<li>
<p>Ensure that <code class="codeph">/opt/oracle/bda/BdaShip.json</code> exists.</p>
</li>
<li>
<p>Reimage the rack:</p>
<pre dir="ltr">
./reimagerack deploy ship
</pre></li>
</ol>
</li>
</ul>
</li>
<li>
<p>Run Mammoth.</p>
</li>
</ol>
<div class="infoboxnotealso" id="GUID-1ED03FDD-CFAE-4A97-A54F-FFA3BB08E7B6__GUID-14B30D74-7820-472C-A6F2-C01103D195D1">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="q">"<a href="configurator.htm#GUID-92C6E1FE-6107-4170-BC08-66C4CF9FEE41">Generating the Configuration Files</a>"</span></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-452E29B5-1282-44D7-83CE-72C26171DC9E">reimagerack</a> for complete syntax of the <code class="codeph">reimagerack</code> command.</p>
</li>
<li>
<p><span class="q">"<a href="mammoth.htm#GUID-F372AB92-C9E3-4B59-832A-662504B25F76">Installing the Software</a>"</span> for instructions on running Mammoth.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76859"></a>
<div class="props_rev_3"><a id="GUID-BADEA83A-4E51-4ADD-ABD6-800DFEF3BBE3"></a>
<h3 id="BIGOG-GUID-BADEA83A-4E51-4ADD-ABD6-800DFEF3BBE3" class="sect3"><span class="enumeration_section">10.9.3</span> Reimaging an Oracle Big Data Appliance Cluster</h3>
<div>
<div class="section">
<p>Follow this procedure to reimage a group of servers that the Mammoth utility has deployed as a single cluster. This can only be used on a group of servers that has been deployed as a single cluster using Mammoth. You can either reapply the network settings that are in currently in effect or revert to factory settings.</p>
<div class="infobox-note" id="GUID-BADEA83A-4E51-4ADD-ABD6-800DFEF3BBE3__GUID-5ACD4EE4-8958-4BF2-B7E3-2895AFD87400">
<p class="notep1">Caution:</p>
<p>If you reimage a cluster, then all files and data on the cluster are deleted. Reimaging is <span class="italic">not</span> required for a software upgrade.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Mandatory Prerequisites</p>
<p>You must rename the files &lt;<span class="italic"><code>rack_name</code></span>&gt;<code>-rack-network.json</code> and &lt;<span class="italic"><code>cluster_name</code></span>&gt;<code>-cluster-network.json</code> generated by the Oracle Big Data Appliance configuration utility to <code>rack-network.json</code> and <code>cluster-network.json</code> , respectively. In other words, truncate the rack name and cluster name prefixes as well as the first hypen.&nbsp;The only purpose of those prefixes is to enable you to distinguish one cluster or rack from another in the output of the configuration utility.</p>
<div class="infobox-note" id="GUID-BADEA83A-4E51-4ADD-ABD6-800DFEF3BBE3__GUID-A5C3EF7F-ADA1-4B8A-923E-19A117FB1B78">
<p class="notep1">Important:</p>
<span class="bold">Before reimaging,</span> <code>/opt/oracle/bda/rack-network.json</code> and <code>/opt/oracle/bda/rack-network.json</code> <span class="bold">must exist on all nodes of the cluster.</span></div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">To reinstall the base image on all servers in a cluster:</p>
<div class="infobox-tip" id="GUID-BADEA83A-4E51-4ADD-ABD6-800DFEF3BBE3__GUID-74DC12A4-1270-41C6-80C2-B8FD818D1650">
<p class="notep1">Tip:</p>
The <code>reimagecluster</code> utility creates an installer on the internal USB drive of each server in the rack, initializes the installation, and reboots each server. While the servers are down for reboot, you can log on to Integrated Lights Out Manager (ILOM) on each server to monitor progress:
<pre dir="ltr">
&lt;server name&gt;-ilom.&lt;domain&gt;.com
</pre>
<p>Click on <span class="bold">Remote Control -&gt; Redirection -&gt; Launch Remote Console</span> to launch a Java console where you can monitor the re-imaging.</p>
</div>
<ol>
<li>
<p>If the Oracle Big Data Appliance software was installed previously on the rack, then save the<code class="codeph">/opt/oracle/BDAMammoth/mammoth-&lt;<span class="codeinlineitalic">rack_name</span>&gt;.params</code> file (or <code class="codeph">/opt/oracle/BDAMammoth/&lt;<span class="codeinlineitalic">cluster_name</span>&gt;-config.json</code>) to a safe place outside Oracle Big Data Appliance. If the cluster has been upgraded, the file may exist in <code>/opt/oracle/BDAMammoth/previous-BDAMammoth</code> directory.</p>
</li>
<li>
<p>Download the latest Oracle Big Data Appliance Base Image tarball from My Oracle Support to a temporary directory. Copy it onto the first (bottom) server of the cluster to be re-imaged.</p>
</li>
<li>
<p>If re-imaging to your current settings, verify that <code>/opt/oracle/bda/rack-network.json</code> and<code>cluster-network.json</code> reflect the intended network configuration. If they do not, then generate new files using Oracle Big Data Appliance Configuration Generation Utility.</p>
</li>
<li>
<p>Establish an SSH connection to the first server and log in as <code class="codeph">root</code>.</p>
</li>
<li>
<p>Ensure that password-less SSH has been setup on the cluster (<code class="codeph">dcli -C hostname</code> should run without errors). If it has not been setup, run <code class="codeph">setup-root-ssh -C</code>.</p>
<pre dir="ltr">
# setup-root-ssh -C 
Enter root password: 
... 
... 
setup-root-ssh succeeded
</pre>
<p><code class="codeph">dcli -C hostname</code> must run without errors and return the host names of all Oracle Big Data Appliance servers in the cluster. If not, then follow the steps in <span class="q">"<a href="dcli.htm#GUID-3E1D048B-3EDF-4E14-81E8-93741428708B">Setting Up Passwordless SSH</a>"</span>. Do not continue until the <code class="codeph">dcli -C hostname</code> command runs successfully on all servers.</p>
</li>
<li>
<p>Ensure that there is at least 4 GB free in the / partition of all servers:</p>
<pre dir="ltr">
# dcli -C df -h /
10.xxx.xxx.xx: Filesystem      Size  Used Avail Use% Mounted on 
10.xxx.xxx.xx: /dev/md2        459G   49G  387G  12% / 
10.xxx.xxx.xx: Filesystem      Size  Used Avail Use% Mounted on
...
</pre></li>
<li>
<p>Unzip the downloaded base image ZIP file. For example:</p>
<pre dir="ltr">
<span class="bold"># unzip p&lt;<span class="italic">number</span>&gt;_&lt;<span class="italic">version</span>&gt;_Linux-x86-64.zip</span>
Archive: p&lt;<span class="italic">number</span>&gt;_&lt;<span class="italic">version</span>&gt;_Linux-x86-64.zip
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/
extracting: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/orabalancer-&lt;<span class="italic">version</span>&gt;-h2.zip
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/orabalancer-&lt;<span class="italic">version</span>&gt;-h2.noarch.rpm
extracting: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/BALANCER/orabalancerdemo-&lt;<span class="italic">version</span>&gt;-h2.zip
creating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/CELL/
inflating: BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE/Extras/CELL/bd_cell-&lt;<span class="italic">version</span>&gt;_LINUX.X64_160506.11   
...
</pre></li>
<li>
<p>Change to the subdirectory created in the previous step:</p>
<pre dir="ltr">
# cd BDABaseImage-ol6-&lt;<span class="italic">version</span>&gt;_RELEASE 
</pre></li>
<li>
<p>Use one of the following procedures to re-image the entire Oracle Big Data Appliance. The first alternative is to retain your existing configuration . The second is to restore to factory settings (prior to Oracle Big Data Appliance Configuration Utility setup) .</p>
<p><span class="bold">Reimage and Retain Existing Network Settings</span></p>
<ol>
<li>
<p>At <code class="codeph">/opt/oracle/bda/</code>, check that both <code>network.json</code> and <code>BdaShip.json</code> are listed.</p>
<pre dir="ltr">
# ls *.json
network.json BdaShip.json
</pre>
<p>If <code>network.json</code> is not listed, locate the customer-specific network.json file (the one that describes the configuration you want to keep). First check to ensure that this file defines correct network settings. If it does not, generate a new file using Oracle Big Data Appliance Configuration Generation Utility. Then copy the file to <code>/opt/oracle/bda</code> and rename it to <code class="codeph">network.json</code>.</p>
</li>
<li>
<p>Use dcli to copy <code class="codeph">network.json</code> to all nodes of the cluster.</p>
<pre dir="ltr">
#  dcli -C -f /opt/oracle/bda/network.json -d /opt/oracle/bda/
</pre></li>
<li>
<p>Execute the <code class="codeph">./reimagecluster</code> command.&nbsp; Partial output of the command is shown below.</p>
<pre dir="ltr">
# ./reimagerack
Passwordless SSH set up to all hosts : xxx.xxx.xx.xx xxx.xxx.xx.xx xxx.xxx.xx.xx xxx.xxx.xx.xx xxx.xxx.xx.xx 
 xxx.xxx.xx.xx 
Using /tmp/BDABaseImage-ol6-&lt;version&gt;_RELEASE/BDABaseImage-ol6-&lt;version&gt;_RELEASE.iso to re-image
BDABaseImage-ol6-&lt;version&gt;_RELEASE.iso: OK
Re-imaging to existing customer network settings

FINAL CONFIRMATION : All of the following hosts will be completely erased, re-imaged and initialized including resetting of the iloms: xxx.xxx.xx.xx xxx.xxx.xx.xx xxx.xxx.xx.xx xxx.xxx.xx.xx xxx.xxx.xx.xx xxx.xxx.xx.xx
Proceed [y/n]?
y
Running hardware checks on all nodes...
...
Rebooting all servers  
Broadcast message from root@bda1node01.example.com (unknown) at 15:58 ...  
The system is going down for reboot NOW! 
</pre></li>
</ol>
<p><span class="bold">To Reimage to Factory Network Settings</span></p>
<ol>
<li>
<p>As described in Step 1, check that <code>/opt/oracle/bda/rack-network.json</code> and <code>cluster-network.json</code> have been copied to a safe location outside Oracle Big Data Appliance and that <code class="codeph">/opt/oracle/bda/BdaShip.json</code> exists.</p>
</li>
<li>
<p>Reimage the cluster to factory-shipped settings with the following command:</p>
<pre dir="ltr">
# ./reimagecluster deploy ship
</pre></li>
</ol>
</li>
<li>Whether you re-imaged with existing network settings or restored to factory settings, the final steps are the same. After reboot from <code class="codeph">reimagecluster</code> completes, run <code class="codeph">setup-root-ssh</code> to re-establish a connection to all the servers in the rack. This is&nbsp;necessary so that the dcli command can be run to reboot all the servers again.
<pre dir="ltr">
# setup-root-ssh
Enter root password:
...
setup-root-ssh succeeded
</pre></li>
<li>
<p>Reboot all servers once again using the dcli reboot command.</p>
<pre dir="ltr">
# dcli reboot
</pre></li>
<li>
<p>Verify that the files <code>/root/BDA_IMAGING_SUCCEEDED</code> and <code>/root/BDA_REBOOT_SUCCEEDED</code> exist on each server in the rack.</p>
<pre dir="ltr">
# dcli ls -lrt /root/BDA_* 
</pre>
<p>Check that the date and timestamp of <code>/root/BDA_REBOOT_SUCCEEDED</code> correspond to the time of the reboot in the reimaging process. The file may be zero-byte or may contain some INFO messages.</p>
</li>
<li>
<p>Verify the installed base image version:</p>
<pre dir="ltr">
# imageinfo
Big Data Appliance Image Info
IMAGE_VERSION : &lt;version&gt;
IMAGE_CREATION_DATE : Wed May 18 20:19:54 UTC 2016
IMAGE_LABEL : BDA_&lt;<span class="italic">version</span>&gt;_LINUX.X64_RELEASE
LINUX_VERSION : Oracle Linux Server release &lt;<span class="italic">version</span>&gt;
KERNEL_VERSION : 2.&lt;<span class="italic">version</span>&gt;.el6uek.x86_64
BDA_RPM_VERSION : bda-&lt;version&gt;-1.el6.x86_64
OFED_VERSION : OFED-IOV-&lt;<span class="italic">version</span>&gt;
JDK_VERSION : jdk1.&lt;<span class="italic">version</span>&gt;-fcs.x86_64
</pre></li>
</ol>
<p>You can now run the Mammoth utility to bring the system up to the latest Oracle Big Data Appliance version.</p>
<div class="infoboxnotealso" id="GUID-BADEA83A-4E51-4ADD-ABD6-800DFEF3BBE3__GUID-93D9D24F-5B3C-49FF-94FA-C4AA54DB0D8E">
<p class="notep1">See Also:</p>
<ul style="list-style-type: disc;">
<li>
<p>This MOS note provides additional details on reimaging: <a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=265220094497088&amp;parent=DOCUMENT&amp;sourceId=1485745.1&amp;id=2173434.1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=13naqn2r2e_175" target="_blank">Oracle Big Data Appliance Base Image Version 4.5.0 for New Installations or Reprovisioning Existing Installations on Oracle Linux 6 (Doc ID 2173434.1)</a></p>
</li>
<li>
<p><a href="mammoth.htm#GUID-AE60E01C-0853-487A-A43A-A687470E3876">About the Mammoth Utility</a></p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BIGOG76900"></a>
<div class="props_rev_3"><a id="GUID-24573DBB-79A4-4CFB-8526-2A9E840E4097"></a>
<h2 id="BIGOG-GUID-24573DBB-79A4-4CFB-8526-2A9E840E4097" class="sect2"><span class="enumeration_section">10.10</span> Installing a One-Off Patch</h2>
<div>
<div class="section">
<p>One-off patch bundles provide a fix to specific bugs in one or more releases. You use Mammoth to apply the patch to your cluster.</p>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">To install a one-off patch bundle:</p>
<ol>
<li>
<p>Download the patch bundle from the Automated Release Update (ARU) system to a directory such as <code class="codeph">/tmp</code> on the first node of the Oracle Big Data Appliance cluster.</p>
<p>The file is named <code class="codeph">BDA-patch-</code><span class="italic"><code class="codeph">release-patch</code></span><code class="codeph">.zip</code>. The examples in this procedure use the name <code class="codeph">BDA-patch-&lt;<span class="codeinlineitalic">version&gt;</span>-123456.zip</code>.</p>
</li>
<li id="GUID-24573DBB-79A4-4CFB-8526-2A9E840E4097__BABJHCCA">
<p>Unzip the file. For example:</p>
<pre dir="ltr">
# <span class="bold">unzip BDA-patch-&lt;<span class="italic">version</span>&gt;-123456.zip</span>
Archive:  BDA-patch-&lt;<span class="italic">version</span>&gt;-123456.zip
   creating: BDA-patch-&lt;<span class="italic">version</span>&gt;-123456/
  inflating: BDA-patch-&lt;<span class="italic">version</span>&gt;-123456/BDA-patch-&lt;version&gt;-123456.run 
  inflating: BDA-patch-&lt;<span class="italic">version</span>&gt;-123456/README.txt
</pre></li>
<li>
<p>Change to the patch directory created in Step 2. For example:</p>
<pre dir="ltr">
$ cd BDA-patch-&lt;<span class="italic">version</span>&gt;-123456
</pre></li>
<li>
<p>Extract the contents of the run file. For example:</p>
<pre dir="ltr">
$ <span class="bold">./BDA-patch-&lt;<span class="italic">version</span>&gt;-123456.run</span>
Big Data Appliance one-off patch 123456 for v&lt;version&gt; Self-extraction
 
Removing existing temporary files
 
Generating /tmp/BDA-patch-&lt;version&gt;-123456.tar
Verifying MD5 sum of /tmp/BDA-patch-&lt;<span class="italic">version</span>&gt;-123456.tar
/tmp/BDA-patch-&lt;<span class="italic">version</span>&gt;-123456.tar MD5 checksum matches
 
Extracting /tmp/BDA-patch-&lt;<span class="italic">version</span>&gt;-123456.tar to /opt/oracle/BDAMammoth/patches/123456
Removing temporary files
 
Please "cd /opt/oracle/BDAMammoth" before running "./mammoth -p 123456"
</pre></li>
<li>
<p>Change to the BDAMammoth directory:</p>
<pre dir="ltr">
$ cd /opt/oracle/BDAMammoth
</pre></li>
<li>
<p>Install the patch. For example:</p>
<pre dir="ltr">
$ ./mammoth -p 123456
</pre>
<p>Mammoth prompts you to choose whether or not you want to load the patch as rolling upgrade. (See <span class="q">"<a href="mammoth.htm#GUID-FD6DE509-12FA-4CE5-A454-DF61AE04C19B">About Rolling Upgrades</a>"</span>)</p>
<p>Alternatively, you can use the <code class="codeph">bdacli</code> command. See <span class="q">"<a href="utilities.htm#GUID-685D1923-EC2A-42B6-8D97-1DFB8239D57C">bdacli</a>"</span>.</p>
</li>
</ol>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76663"></a><a id="BIGOG76662"></a>
<div class="props_rev_3"><a id="GUID-2C9C6188-2D32-41C0-9BE7-098109B7416F"></a>
<h2 id="BIGOG-GUID-2C9C6188-2D32-41C0-9BE7-098109B7416F" class="sect2"><span class="enumeration_section">10.11</span> Mammoth Software Installation and Configuration Utility</h2>
<div>
<p>You must log in as <code class="codeph">root</code> on the first server and change to the /opt/oracle/<a id="d43346e3553" class="indexterm-anchor"></a>BDAMammoth directory to use Mammoth. It has this <a id="d43346e3556" class="indexterm-anchor"></a>syntax:</p>
<pre dir="ltr">
./mammoth <span class="italic">option</span> [<span class="italic">cluster_name</span>] ]
</pre>
<p><a id="d43346e3570" class="indexterm-anchor"></a>In this command, <span class="italic">cluster_name</span> is the name of the cluster You must enter <span class="italic">cluster_name</span> in the first command exactly as it appears in (<span class="italic"><code class="codeph">cluster_name</code></span><code class="codeph">-config.json</code>). Afterward, <span class="italic">cluster_name</span> defaults to the rack specified in a previous <code class="codeph">mammoth</code> command.</p>
<p>You must finish installing one rack before starting the installation of another rack.</p>
<div class="example" id="GUID-2C9C6188-2D32-41C0-9BE7-098109B7416F__GUID-D3622EA5-1D48-498F-A77C-B718E75F38D3">
<p class="titleinexample">Example 10-1 Mammoth Syntax Examples</p>
<p>This command displays Help for the Mammoth utility:</p>
<pre dir="ltr">
./mammoth -h
</pre>
<p>This command does a complete install on rack bda3:</p>
<pre dir="ltr">
./mammoth -i bda3
</pre>
<p>This command runs steps 2 through 6 on the rack being set up:</p>
<pre dir="ltr">
./mammoth -r 2-6
</pre>
<p>This command generates a parameter file to add six new servers over a starter rack, beginning with node07, to an existing cluster:</p>
<pre dir="ltr">
./mammoth -e node07 node08 node09 node10 node11 node12
</pre></div>
<!-- class="example" --></div>
<a id="BIGOG76838"></a>
<div class="props_rev_3"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244"></a>
<h3 id="BIGOG-GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244" class="sect3"><span class="enumeration_section">10.11.1</span> Mammoth Options</h3>
<div>
<div class="section">
<p><a id="d43346e3635" class="indexterm-anchor"></a>The syntax of the <code class="codeph">mammoth</code> command supports the configuration of new clusters. You can also use the Mammoth bundle to upgrade from earlier releases.</p>
<dl>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-12FDBF1B-8486-4075-A9CE-F6A3FDEC84AC"><!-- --></a>-c</dt>
<dd>
<p>Run the Oracle Big Data Appliance cluster checks.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-DA9A4131-7090-4BC3-8253-984CA517DD3A"><!-- --></a>-e <span class="italic">newnode1 newnode2 newnode3...</span></dt>
<dd>
<p>Generates a parameter file for the list of servers to be added to a cluster. It then adds the new node or nodes to the cluster and installs required software on these nodes.</p>
<p>The servers in the list can be in the same rack or multiple racks.</p>
<p>Reboots normally occur only for the new nodes and only at the initial update of the factory image.</p>
<p>The parameter file generated is <code class="codeph">opt/oracle/BDAMammoth/&lt;<span class="codeinlineitalic">cluster_name</span>&gt;-config.json</code>, where &lt;<code>cluster-name</code>&gt; is the name of the cluster being extended. No passwords are included in the parameter file, so you must enter them when running Mammoth. Cluster extension expects the default root password on nodes in the extension, so you should retain that password until the extension has completed. Be sure to change passwords afterward.</p>
<p>On Oracle NoSQL Database clusters, Mammoth prompts for the kind of zone for the new nodes. You can choose from an existing zone, a new primary zone, or a new secondary zone. When adding to an existing zone, Mammoth lists the zones that you can use. When creating a new zone, Mammoth prompts for the zone name and replication factor.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-BE4F5EEA-9E9F-460A-BC02-BC8B83B62D4B"><!-- --></a>-h</dt>
<dd>
<p>Displays command Help including command usage and a list of steps.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-C79BF32F-21D4-4AE4-BADE-C5385B14438C"><!-- --></a>-i <span class="italic">cluster_name</span></dt>
<dd>
<p>Runs all mandatory steps on the cluster, equivalent to <code class="codeph">-r 1-18</code> for a full rack. Use this option when configuring a new rack or adding a group of servers to a cluster.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-8E8D419D-83AF-4E58-9FE0-F77CD18D8380"><!-- --></a>-l</dt>
<dd>
<p>Lists the steps of the Mammoth utility.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-3381ABF7-D969-4AD2-9D30-42D6F2C6AF8C"><!-- --></a>-p</dt>
<dd>
<p>Upgrades the software on the cluster to the current version or installs a one-off patch.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-8038B7CC-EE50-4747-8019-B7DF8ED7F4AE"><!-- --></a>-r <span class="italic">n-N</span></dt>
<dd>
<p>Runs steps <span class="italic">n</span> through <span class="italic">N</span> of Mammoth while no errors occur.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-27E51A61-B5AE-41F7-A0DD-3E7D6334DF2D"><!-- --></a>-s <span class="italic">n</span> [<span class="italic">cluster_name</span>]</dt>
<dd>
<p>Runs step <span class="italic">n</span>. Enter <span class="italic">cluster_name</span> to identify another cluster on the same rack. See the <code class="codeph">-e</code> option.</p>
</dd>
<dt class="dlterm"><a id="GUID-6A312CB7-95FA-49DE-8725-D019CB8ED244__GUID-F4D9B894-F863-47BB-AEFD-F056A49001FC"><!-- --></a>-v</dt>
<dd>
<p>Displays the version number of the Mammoth.</p>
</dd>
</dl>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76667"></a><a id="BIGOG76671"></a><a id="BIGOG76672"></a><a id="BIGOG76673"></a><a id="BIGOG76674"></a><a id="BIGOG76676"></a><a id="BIGOG76677"></a><a id="BIGOG76678"></a><a id="BIGOG76679"></a><a id="BIGOG76680"></a><a id="BIGOG76682"></a><a id="BIGOG76989"></a><a id="BIGOG76955"></a><a id="BIGOG76829"></a><a id="BIGOG76683"></a><a id="BIGOG76684"></a><a id="BIGOG76685"></a><a id="BIGOG244"></a>
<div class="props_rev_3"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E"></a>
<h3 id="BIGOG-GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E" class="sect3"><span class="enumeration_section">10.11.2</span> Mammoth Installation Steps</h3>
<div>
<div class="section">
<p>Following are descriptions of the steps that the Mammoth performs when installing the software.</p>
<dl>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__BABDDIBG"><!-- --></a>Step 1&nbsp;&nbsp;&nbsp;PreinstallChecks</dt>
<dd>
<p>This step performs several tasks:</p>
<ul style="list-style-type: disc;">
<li>
<p>Validates the configuration files and prompts for the passwords.</p>
</li>
<li>
<p>Sets up a Secure Shell (SSH) for the root user so you can connect to all addresses on the administrative network without entering a password.</p>
</li>
<li>
<p>Sets up passwordless SSH for the root user on the InfiniBand network.</p>
</li>
<li>
<p>Generates <code class="codeph">/etc/hosts</code> from the configuration file and copies it to all servers so they use the InfiniBand connections to communicate internally. The file maps private IP addresses to public host names.</p>
</li>
<li>
<p>Sets up an alias to identify the node where the Mammoth is run as the puppet master node. For example, if you run the Mammoth from bda1node01 with an IP address 192.168.41.1, then a list of aliases for that IP address includes bda1node01-master. The Mammoth uses Puppet for the software installation.</p>
</li>
<li>
<p>Checks the network timing on all nodes. If the timing checks fail, then there are unresolved names and IP addresses that will prevent the installation from running correctly. Fix these issues before continuing with the installation.</p>
</li>
</ul>
<p>This step also performs a variety of hardware and software checks. A failure in any of these checks causes the Mammoth to fail:</p>
<ul style="list-style-type: disc;">
<li>
<p>The ARP cache querying time is 2 seconds or less.</p>
</li>
<li>
<p>All server clocks are synchronized within 10 seconds of the current server.</p>
</li>
<li>
<p>All servers succeeded on the last restart and generated a <code class="codeph">/root/BDA_REBOOT_SUCCEEDED</code> file.</p>
</li>
<li>
<p>The <code class="codeph">bdacheckhw</code> utility succeeds.</p>
</li>
<li>
<p>The <code class="codeph">bdachecksw</code> utility succeeds.</p>
</li>
</ul>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-359887C3-06B2-4EE8-8826-9C058E67F8FE"><!-- --></a>Step 2&nbsp;&nbsp;&nbsp;SetupPuppet</dt>
<dd>
<p>This step configures puppet agents on all nodes and start them, configures a puppet master on the node where the Mammoth is being run, waits for the agents to submit their certificates, and automates their signing. This step also changes the root password on all nodes (optional). After this step is completed, Puppet can deploy the software.</p>
<p><a id="d43346e3936" class="indexterm-anchor"></a>Puppet is a distributed configuration management tool that is commonly used for managing Hadoop clusters. The puppet master is a parent service and maintains a Puppet repository. A puppet agent operates on each Hadoop node.</p>
<p>A file named <code class="codeph">/etc/puppet/puppet.conf</code> resides on every server and identifies the location of the puppet master.</p>
<p>Puppet operates in two modes:</p>
<ul style="list-style-type: disc;">
<li>
<p>Periodic pull mode in which the puppet agents periodically contact the puppet master and asks for an update, or</p>
</li>
<li>
<p>Kick mode in which the puppet master alerts the puppet agents that a configuration update is available, and the agents then ask for the update. Puppet operates in kick mode during the Mammoth installation.</p>
</li>
</ul>
<p>In both modes, the puppet master must trust the agent. To establish this trust, the agent sends a certificate to the puppet master node where the <code class="codeph">sys</code> admin process signs it. When this transaction is complete, the puppet master sends the new configuration to the agent.</p>
<p>For subsequent steps, you can check the Puppet log files on each server, as described in <span class="q">"<a href="mammoth.htm#GUID-C9A914CE-524B-4EF4-9EDF-13D768530195">What If an Error Occurs During the Installation?</a>"</span>.</p>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-3903F346-9AFB-448F-829C-2368EAF855B1"><!-- --></a>Step 3&nbsp;&nbsp;&nbsp;UpdateBaseImage</dt>
<dd>
<p>Installs the most recent Oracle Big Data Appliance image and system parameter settings. The system automatically restarts if the kernel is upgraded.</p>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-6245E85D-6E01-42B3-9D33-496D98A1DE0B"><!-- --></a>Step 4&nbsp;&nbsp;&nbsp;PrepareBaseImage</dt>
<dd>
<ul style="list-style-type: disc;">
<li>
<p>Copies third-party licenses to <code class="codeph">/opt/oss/src/OSSLicenses.pdf</code> on every server, as required by the licensing agreements.</p>
</li>
<li>
<p>Copies third-party <a id="d43346e3984" class="indexterm-anchor"></a><a id="d43346e3986" class="indexterm-anchor"></a>software source code to <code class="codeph">/opt/oss/src/</code> on every server, as required by the licensing agreements.</p>
<p>Mammoth does not copy the source code to Oracle NoSQL Database clusters.</p>
</li>
<li>
<p>Creates <a id="d43346e3997" class="indexterm-anchor"></a><a id="d43346e3999" class="indexterm-anchor"></a><a id="d43346e4001" class="indexterm-anchor"></a><a id="d43346e4003" class="indexterm-anchor"></a><a id="d43346e4005" class="indexterm-anchor"></a><a id="d43346e4007" class="indexterm-anchor"></a><a id="d43346e4009" class="indexterm-anchor"></a>the <code class="codeph">hdfs</code> and <code class="codeph">mapred</code> users, and the <code class="codeph">hadoop</code> group. It also creates the <code class="codeph">oracle</code> user and the <code class="codeph">dba</code> and <code class="codeph">oinstall</code> groups.</p>
<p>The various packages installed in later steps also create users and groups during their installation.</p>
<div class="infoboxnotealso" id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-B8E9A33D-E99F-454B-A867-9FE8B5C5EBED">
<p class="notep1">See Also:</p>
<p><a class="olink BIGUG132" target="_blank" href="../BIGUG/admin.htm#BIGUG132"><span class="italic">Oracle Big Data Appliance Software User's Guide</span></a> for more information about users and groups.</p>
</div>
</li>
<li>
<p>The NameNode data is copied to multiple places to prevent a loss of this critical information should a failure occur in either the disk or the entire node where they are set up.</p>
</li>
</ul>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-853D5C42-7805-4386-A6A9-580231F1D4AA"><!-- --></a>Step 5&nbsp;&nbsp;&nbsp;SetupMySQL</dt>
<dd>
<p>Installs and configures MySQL Database. This step creates the primary database and several databases on node03 for use by Cloudera Manager. It also sets up replication of the primary database to a backup database on node02.</p>
<p>Mammoth does not install MySQL Database on Oracle NoSQL Database clusters.</p>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-F983E92D-F091-4D15-A540-81B5B9F15124"><!-- --></a>Step 6&nbsp;&nbsp;&nbsp;SetupKDC</dt>
<dd>
<p>Configures the Kerberos Key Distribution Center (KDC) that is used to set up security on the cluster.</p>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-322BCA1F-B545-4C91-9975-E006C779E272"><!-- --></a>Step 7&nbsp;&nbsp;&nbsp;InstallHadoop</dt>
<dd>
<p>Installs all packets in Cloudera's Distribution including Apache Hadoop (CDH) and Cloudera Manager. It then starts the Cloudera Manager server on node03 and configures the cluster.</p>
<p>Mammoth does not install CDH or Cloudera Manager on Oracle NoSQL Database clusters.</p>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-AABEEF86-ABE0-4630-81CB-C601D732F682"><!-- --></a>Step 8&nbsp;&nbsp;&nbsp;StartHadoopServices</dt>
<dd>
<p>Starts the agents on all nodes and starts all CDH services. Also enables HTTPS for Cloudera Manager, Hue, and Oozie if HTTPS/ Network Encryption was enabled.</p>
<p>After this step, you have a fully functional Hadoop installation.</p>
<p>Cloudera Manager runs on port 7180 of node03. You can open it in a browser, for example:</p>
<pre dir="ltr">
http://bda1node03.example.com:7180
</pre>
<p>In this example, bda1node02 is the name of node02 and <code class="codeph">example.com</code> is the domain. The default user name and password is <code class="codeph">admin</code>. You are prompted to change the password at the end of this step.</p>
<p>Note that Mammoth does not install or start CDH services on Oracle NoSQL Database clusters.</p>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-0F93A088-C57A-44DE-BF70-1C5C8BD1EAA5"><!-- --></a>Step 9&nbsp;&nbsp;&nbsp;InstallBDASoftware</dt>
<dd>
<p>Installs the server-side components of Oracle Big Data Connectors, if this option was selected in Oracle Big Data Appliance Configuration Generation Utility. Oracle Big Data Connectors must be licensed separately. Optional.</p>
<p>Installs the server-side components of Oracle Big Data SQL, if this option was selected in Oracle Big Data Appliance Configuration Generation Utility. For Oracle Big Data SQL support of Oracle NoSQL Database, this step installs the client libraries (kvclient.jar) on the CDH nodes. Oracle Big Data SQL must be licensed separately. Optional.</p>
<p>Installs Oracle NoSQL Database on clusters allocated to its use. Enterprise Edition requires a separate license.</p>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-8A9B06EC-7035-403C-B5F0-16BAE934095B"><!-- --></a>Step 10&nbsp;&nbsp;&nbsp;SetupHadoopSecurity</dt>
<dd>
<p>Actions performed in this step are based upon the choices you made in the Oracle Big Data Appliance Configuration Utility prior to installation.</p>
<ul style="list-style-type: disc;">
<li>
<p>Configures HTTPS/ Network Encryption if this option was selected.</p>
</li>
<li>
<p>Configures HDFS Transparent Encryption if this option was selected.</p>
<p>Mammoth sets up the The Navigator Key Trustee services required by HDFS Transparent Encryption based on whether you chose local or external Key Trustee servers in the configuration utility prior to installation:</p>
<ul style="list-style-type: disc;">
<li>
<p>If you had selected <span class="bold">Setup Key Trustee Servers on the BDA</span> in the configuration utility, Mammoth will setup up active and passive Key Trustee servers locally on the Oracle Big Data Appliance.</p>
</li>
<li>
<p>If you chose to use external Key Trustee Servers, the connection to the external servers is configured in this setup. (Note that you must have already configured the external Navigator Key Trustee Servers as described in MOS Doc ID 2112644.1)</p>
</li>
</ul>
</li>
<li>
<p>Configures Kerberos authentication if this option was selected. There are no prerequisites if you set up the key distribution center on Oracle Big Data Appliance. Otherwise, see <span class="q">"<a href="mammoth.htm#GUID-5D0B03C7-7205-4752-BBB9-CFBD69EFD109">Installation Prerequisites</a>."</span></p>
</li>
</ul>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-C727217E-AC92-4EB1-9D4E-EEFB698C39A8"><!-- --></a>Step 11&nbsp;&nbsp;&nbsp;SetupASR</dt>
<dd>
<p>Installs and configures Auto Service Request (ASR). Optional.</p>
<p>This step does the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Installs the required software packages</p>
</li>
<li>
<p>Configures the trap destinations</p>
</li>
<li>
<p>Starts the monitoring daemon</p>
</li>
</ul>
<p>To activate the assets from ASR Manager, see <span class="q">"<a href="asr.htm#GUID-A78023F5-8D00-4522-A187-AE2A7471AFC3">Verifying ASR Assets</a>"</span>.</p>
<div class="infobox-note" id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-66D1F62C-44FA-496C-BDD3-C289B4F1D9CF">
<p class="notep1">Note:</p>
<p>For this step to run successfully, the ASR host system must be up with ASR Manager running and configured properly. See <a href="asr.htm#GUID-6D1BCF7C-FCDD-4767-A10C-BD5519C3EF6A">Setting Up Auto Service Request</a>.</p>
</div>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__CACDJGFE"><!-- --></a>Step 12&nbsp;&nbsp;&nbsp;CleanupInstall</dt>
<dd>
<p>Performs the following:</p>
<ul style="list-style-type: disc;">
<li>
<p>Changes the Cloudera Manager password if specified in the Installation Template.</p>
</li>
<li>
<p>Deletes temporary files created during the installation.</p>
</li>
<li>
<p>Copies log files from all nodes to subdirectories in <code class="codeph">/opt/oracle/bda/install/log</code>.</p>
</li>
<li>
<p>Runs cluster verification checks, including TeraSort, to ensure that everything is working properly. It also generates an install summary. All logs are stored in a subdirectory under <code class="codeph">/opt/oracle/bda/install/log</code> on node01.</p>
</li>
</ul>
</dd>
<dt class="dlterm"><a id="GUID-A1C3510A-77A2-4B1D-A4B1-555F1833149E__GUID-080CA05A-535D-46C9-B2CC-3F1E8087E3B0"><!-- --></a>Step 13&nbsp;&nbsp;&nbsp;CleanupSSHroot (Optional)</dt>
<dd>
<p>Removes passwordless SSH for <code class="codeph">root</code> that was set up in "PreinstallChecks".</p>
</dd>
</dl>
</div>
<!-- class="section" --></div>
</div>
</div>
<a id="BIGOG76860"></a>
<div class="props_rev_3"><a id="GUID-C87C7224-3ED6-4C75-BD37-08C98FCB94CA"></a>
<h2 id="BIGOG-GUID-C87C7224-3ED6-4C75-BD37-08C98FCB94CA" class="sect2"><span class="enumeration_section">10.12</span> Oracle Big Data Appliance Base Imaging Utilities</h2>
<div>
<p>The following utilities are distributed in the base image bundle. To run the utilities, you must be logged in as <code class="codeph">root</code>.</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph"><a href="mammoth.htm#GUID-B731C141-ABC0-4173-9FBD-7593AB616230">makebdaimage</a></code></p>
</li>
<li>
<p><code class="codeph"><a href="mammoth.htm#GUID-38C558D8-F3AB-45D6-A3AC-BA1012274075">reimagecluster</a></code></p>
</li>
<li>
<p><code class="codeph"><a href="mammoth.htm#GUID-452E29B5-1282-44D7-83CE-72C26171DC9E">reimagerack</a></code></p>
</li>
</ul>
</div>
<a id="BIGOG76861"></a>
<div class="props_rev_3"><a id="GUID-B731C141-ABC0-4173-9FBD-7593AB616230"></a>
<h3 id="BIGOG-GUID-B731C141-ABC0-4173-9FBD-7593AB616230" class="sect3"><span class="enumeration_section">10.12.1</span> makebdaimage</h3>
<div>
<div class="section">
<p>Reinstalls the base image on a single server, a cluster, or an entire rack. Both <code class="codeph"><a href="mammoth.htm#GUID-38C558D8-F3AB-45D6-A3AC-BA1012274075">reimagecluster</a></code> and <code class="codeph"><a href="mammoth.htm#GUID-452E29B5-1282-44D7-83CE-72C26171DC9E">reimagerack</a></code> call this utility.</p>
<p>The <code class="codeph">makedbaimage</code> utility has this syntax:</p>
<pre dir="ltr">
makebdaimage [--usb | --usbint] [--noiloms] /<span class="italic">path</span>/BDABaseImage-<span class="italic">version</span>_RELEASE.iso /<span class="italic">path</span>/BDdaDeploy.json <span class="italic">target_servers</span>
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Options</p>
<dl>
<dt class="dlterm"><a id="GUID-B731C141-ABC0-4173-9FBD-7593AB616230__GUID-D34E37FC-6FAD-4F92-8B82-B860D9B5F04B"><!-- --></a>--usb | --usbint</dt>
<dd>
<p>Identifies the USB port that will be used for reimaging. Use <code class="codeph">--usb</code> for the external USB drive, or <code class="codeph">--usbint</code> for the internal drive. The internal USB drive contains a full Linux installation.</p>
<p>To use the <code class="codeph">--usbint</code> option, you must be logged in to the target server; otherwise, you reimage the server using the wrong network information.</p>
</dd>
<dt class="dlterm"><a id="GUID-B731C141-ABC0-4173-9FBD-7593AB616230__GUID-59574AF6-D417-4A1E-A9DD-02EBA3757723"><!-- --></a>--noiloms</dt>
<dd>
<p>The reimaging process does not alter the Oracle ILOMs on the target servers.</p>
</dd>
<dt class="dlterm"><a id="GUID-B731C141-ABC0-4173-9FBD-7593AB616230__GUID-42791F83-1EE2-4B9F-9AF4-3A7C5C4F9C95"><!-- --></a><span class="italic">target_servers</span></dt>
<dd>
<p>One or more servers where the image will be installed, which you specify using one of these formats:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="italic"><span class="bold">node_number</span></span></p>
<p>Identifies one server for reimaging. Enter the position of the server in the rack, from 1 to 18, counting from bottom to top.</p>
</li>
<li>
<p><span class="italic"><span class="bold">from</span></span><span class="bold">.json</span> <span class="italic"><span class="bold">to</span></span><span class="bold">.json</span></p>
<p>Identifies the current configuration (<span class="italic"><code class="codeph">from</code></span><code class="codeph">.json</code>) and the desired configuration (<span class="italic"><code class="codeph">to</code></span><code class="codeph">.json</code>). The JSON files can be either the factory configuration in <code class="codeph">BdaShip.json</code> or a custom configuration in <code class="codeph">network.json</code>. You can find them in <code class="codeph">/opt/oracle/bda</code> on configured servers.</p>
</li>
<li>
<p><span class="italic"><span class="bold">to</span></span><span class="bold">.json</span>: Concatenation of JSON files similar to <code class="codeph">network.json</code> and <code class="codeph">BdaShip.json</code>, but containing an extra ETH0_MACS array entry. The first entry in the concatenated file with a matching eth0_mac entry is used when reimaging. The <span class="italic"><code class="codeph">to</code></span><code class="codeph">.json</code> file is used as is.</p>
</li>
</ul>
</dd>
</dl>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76862"></a>
<div class="props_rev_3"><a id="GUID-38C558D8-F3AB-45D6-A3AC-BA1012274075"></a>
<h3 id="BIGOG-GUID-38C558D8-F3AB-45D6-A3AC-BA1012274075" class="sect3"><span class="enumeration_section">10.12.2</span> reimagecluster</h3>
<div>
<div class="section">
<p>Reimages all servers in the cluster in parallel using <code class="codeph">dcli</code> and <code class="codeph">makebdaimage</code>.</p>
<p>The <code class="codeph">reimagecluster</code> utility has this syntax:</p>
<pre dir="ltr">
reimagecluster [--no-iloms] 
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Prerequisites</p>
<ul style="list-style-type: disc;">
<li>
<p>Verify that the following command returns the list of servers in the cluster:</p>
<pre dir="ltr">
$ dcli -C hostname
</pre></li>
<li>
<p>Ensure that exactly one <code class="codeph">BDABaseImage-</code><span class="italic"><code class="codeph">version</code></span><code class="codeph">_RELEASE*.iso</code> file is in the current directory.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Options</p>
<dl>
<dt class="dlterm"><a id="GUID-38C558D8-F3AB-45D6-A3AC-BA1012274075__GUID-8923F4A4-CDC4-44CA-9616-4BE1B0AB7133"><!-- --></a>--no-iloms</dt>
<dd>
<p>The reimaging process does not alter the Oracle ILOMs on the target servers.</p>
</dd>
</dl>
</div>
<!-- class="section" --></div>
</div>
<a id="BIGOG76863"></a>
<div class="props_rev_3"><a id="GUID-452E29B5-1282-44D7-83CE-72C26171DC9E"></a>
<h3 id="BIGOG-GUID-452E29B5-1282-44D7-83CE-72C26171DC9E" class="sect3"><span class="enumeration_section">10.12.3</span> reimagerack</h3>
<div>
<div class="section">
<p>Reimages all servers in the rack in parallel using <code class="codeph">dcli</code> and <code class="codeph">makedbaimage</code>.</p>
<p>The <code class="codeph">reimagerack</code> utility has this syntax:</p>
<pre dir="ltr">
reimagerack [--no-iloms] [--no-macs] [--hosts <span class="italic">n1</span>, <span class="italic">n2</span>...] [<span class="italic">from</span>.json [<span class="italic">to</span>.json]]
</pre></div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Prerequisites</p>
<ul style="list-style-type: disc;">
<li>
<p>Verify that the following command returns the list of servers in the rack:</p>
<pre dir="ltr">
$ dcli -hostname
</pre></li>
<li>
<p>Ensure that exactly one <code class="codeph">BDABaseImage-</code><span class="italic"><code class="codeph">version</code></span><code class="codeph">_RELEASE*.iso</code> file is in the current directory.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead3">Options</p>
<dl>
<dt class="dlterm"><a id="GUID-452E29B5-1282-44D7-83CE-72C26171DC9E__GUID-6C0188E2-A1D3-48AD-A5D3-CDD9839FAFA3"><!-- --></a>--no-iloms</dt>
<dd>
<p>The reimaging process does not alter the Oracle ILOMs on the target servers.</p>
</dd>
<dt class="dlterm"><a id="GUID-452E29B5-1282-44D7-83CE-72C26171DC9E__GUID-730E4E47-DA72-497D-923F-49D449AE19F0"><!-- --></a>--no-macs</dt>
<dd>
<p>The utility does not retrieve the server MAC addresses. Instead, it uses the InfiniBand cabling. Use this option only when restoring the factory settings; you must include both JSON files (<span class="italic"><code class="codeph">from</code></span><code class="codeph">.json</code> and <span class="italic"><code class="codeph">to</code></span><code class="codeph">.json</code>) in the command line.</p>
</dd>
<dt class="dlterm"><a id="GUID-452E29B5-1282-44D7-83CE-72C26171DC9E__GUID-3D638408-8FD3-41C6-8A9A-A313542D8C17"><!-- --></a>--hosts <span class="italic">n1</span>, <span class="italic">n2</span>...</dt>
<dd>
<p>Restricts reimaging to the servers identified by a comma-delimited list of host names or IP addresses, whichever one <code class="codeph">dcli</code> accepts. All servers must be in the list of target servers identified by the <code class="codeph">dcli -t</code> command.</p>
<p>This option enforces the <code class="codeph">--no-macs</code> option, so its restrictions also apply.</p>
</dd>
<dt class="dlterm"><a id="GUID-452E29B5-1282-44D7-83CE-72C26171DC9E__GUID-AA69B013-975F-4DFE-BF4C-E94ABE137674"><!-- --></a><span class="italic">from</span>.json</dt>
<dd>
<p>The full path to the current configuration file, either <code class="codeph">BdaShip.json</code> or <code class="codeph">network.json</code>.</p>
<p>This option defaults to <code class="codeph">/opt/oracle/bda/network.json</code>. If <code class="codeph">network.json</code> is missing, then the option defaults to <code class="codeph">/opt/oracle/bda/BdaShip.json</code>. The servers must already be set to the values in the JSON file used by <code class="codeph">reimagerack</code>.</p>
</dd>
<dt class="dlterm"><a id="GUID-452E29B5-1282-44D7-83CE-72C26171DC9E__GUID-4FE7E135-DD56-4D91-AB98-D5DC45E001E1"><!-- --></a><span class="italic">to</span>.json</dt>
<dd>
<p>The full path to the new network configuration in effect after reimaging. It can be either a <code class="codeph">network.json</code> or a <code class="codeph">BdaShip.json</code> file.</p>
</dd>
</dl>
</div>
<!-- class="section" --></div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment164">
<tr>
<td class="cellalignment197">
<table class="cellalignment169">
<tr>
<td class="cellalignment168"><a href="part-software-installation.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment168"><a href="part-maintenance.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2011, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment199">
<table class="cellalignment167">
<tr>
<td class="cellalignment168"><a href="http://www.docs.oracle.com/bigdata/411/index.html"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment168"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment168"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment168"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
